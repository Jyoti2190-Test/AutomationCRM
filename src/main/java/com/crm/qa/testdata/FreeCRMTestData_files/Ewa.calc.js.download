Type.registerNamespace("_Ewa");_Ewa.InstantaneousSupportInformationManager=function(n,t){this.be=Function.createDelegate(this,this.by);this.bf=Function.createDelegate(this,this.bz);this.bg=Function.createDelegate(this,this.bA);this.bi=Function.createDelegate(this,this.bF);this.T=Function.createDelegate(this,this.bB);this.bd=Function.createDelegate(this,this.bw);this.X=Function.createDelegate(this,this.bx);this.bh=Function.createDelegate(this,this.bm);this.Z=Function.createDelegate(this,this.bD);this.W=Function.createDelegate(this,this.bv);this.ba=Function.createDelegate(this,this.bE);this.Y=Function.createDelegate(this,this.bC);_Ewa.InstantaneousSupportInformationManager.initializeBase(this,[!1]);Diag.a.a(35985034,0,50,"InstantaneousSupportInformationManager ctor start");this.E=n;this.D=t;this.L=null;this.Q=null;this.G=null;this.C=null;this.K=new($$sc.s.$$(_Ewa.Dl));this.I=new($$sc.s.$$($$sc.a));this.F=new Array(0);this.U=new($$sc.s.$$(String));this.P={};this.E.h(this.Y);this.D.D(this.ba);_Ewa.c.a(this.D).a().w(this.W);_Ewa.a.a(348)&&this.E.q(this.Z);this.M(100);Diag.a.a(35985035,0,50,"InstantaneousSupportInformationManager ctor end")};_Ewa.InstantaneousSupportInformationManager.c=function(n,t){var u,i,f,o,s,r,c,v,y;if(!n||!n.length)return new Array(0);if(!t||!t.length){for(u=new Array(n.length),i=0;i<n.length;++i)u[i]=n[i].IfmtIndex;return u}f=new($$sc.s.$$(_Ewa.InstantaneousSupportInformationManager.b));for(var l=n,p=l.length,e=0;e<p;++e)o=l[e],f.b(o.IfmtIndex,new _Ewa.InstantaneousSupportInformationManager.b(o));s=new($$sc.v.$$(Number));for(var a=t,w=a.length,h=0;h<w;++h)r=a[h],(y=f.e(r.IfmtIndex,v={val:c},null),c=v.val,y)&&c.a.FormatString===r.FormatString||s.b(r.IfmtIndex);return s.g()};_Ewa.InstantaneousSupportInformationManager.d=function(n,t){if(!t||t===n.length-1)return!1;var i=n.charAt(t-1),r=n.charAt(t+1);return!(i==="#"||i==="0"||i==="?")||!(r==="#"||r==="0"||r==="?")?!1:!0};_Ewa.InstantaneousSupportInformationManager.a=function(n,t,i){_Ewa.f.b(t,i,!1)||(n[t]=i)};_Ewa.InstantaneousSupportInformationManager.prototype={E:null,D:null,L:null,Q:null,G:null,C:null,O:-1,N:null,S:null,K:null,I:null,R:!1,H:!1,F:null,U:null,P:null,bb:null,bc:null,k:function(n){this.dZ("isim0",n)},g:function(n){this.eb("isim0",n)},i:function(n){this.dZ("isim1",n)},B:function(n){this.eb("isim1",n)},j:function(n){this.dZ("isim2",n)},f:function(n){this.eb("isim2",n)},a:function(){return this.C?this.C.LocaleInformation:null},d:function(){return this.C?this.C.NumberFormats:new Array(0)},b:function(){return this.F&&this.F.length||this.bl(),this.F},c:function(){return this.S},p:function(){return this.C&&!isNullOrUndefined(this.C.InstantaneousCalcWebWorkerPrecisionSamplingRate)?this.C.InstantaneousCalcWebWorkerPrecisionSamplingRate:.001},s:function(){return this.C&&!isNullOrUndefined(this.C.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate)?this.C.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:.1},r:function(){return this.C&&!isNullOrUndefined(this.C.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate)?this.C.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:.2},q:function(){return this.C&&!isNullOrUndefined(this.C.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate)?this.C.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:.001},l:function(){return this.C?this.C.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:50},e:function(){return isNull(this.N)?this.C?this.C.InstantaneousCalcManualMode:!1:this.N},h:function(n,t,i){var r=this.K.e(n,t,0);return!r&&n>0&&this.D&&(Diag.a.a(40468576,0,50,"InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache {0}",n),this.bt(n),i&&(t.val=this.bs(n),r=!0),_Ewa.qU.a(n,this.D.Q())&&(t.val=6)),r},x:function(n){var t=0,i,r;return(r=this.h(n,i={val:t},!0),t=i.val,r)?!t:(Diag.a.a(576320068,0,50,"InstantaneousSupportInformationManager.IsFormatInGeneralCategory: failed to get category from format index {0}",n),!1)},y:function(n){var t=0,i,r;return(r=this.h(n,i={val:t},!0),t=i.val,r)?t===6:(Diag.a.a(23156486,0,50,"InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index {0}",n),!1)},m:function(n){var t=0,i,r;return(r=this.h(n,i={val:t},!0),t=i.val,r)?t===9:(Diag.a.a(39134882,0,50,"InstantaneousSupportInformationManager.isFormatInTextCategory: failed to get category from format index {0}",n),!1)},z:function(n,t){var i=0,r,u;return(u=this.h(t,r={val:i},!0),i=r.val,u)||Diag.a.a(590128400,0,50,"InstantaneousSupportInformationManager.IsLiteralText: failed to get category from format index {0}",t),i===9||!i&&!_Ewa.f.h(n)&&!_Ewa.bB.d(n)&&!_Ewa.bB.f(n)},n:function(n){Diag.a.a(37855392,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");var t={};t.FilterType=0;this.G=_Ewa.k.c(this.D.c().a(),t,_Ewa.n.a(this.bh,n),this.X,null,null,null)},o:function(){this.M(100)},bv:function(){var i=_Ewa.c.a(this.D),n,t,r,u;i&&(n=i.h(null),n&&(t=0,u=this.h(n.a().b(),r={val:t},!0),t=r.val,u))},A:function(n){this.N=n},bt:function(n){var t,r,u,i;if(!this.I||!this.D){Diag.a.a(25747617,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping");return}((u=this.I.e(n,r={val:t},null),t=r.val,!u)||t.b>3)&&(Diag.a.a(24417758,0,50,"Getting number format category for format index: {0}",n),i=_Ewa.Tr.a(this.D.c().a(),n,this.bd,null,null,null,null),i&&this.I.b(n,i))},bs:function(n){return n>=1&&n<=8?1:n>=9&&n<=12?2:n===13||n===14?6:n===15?8:!(n===17|n===18)?n===19?4:n===16||n>=20&&n<=29||n===31?11:n===30?9:n>=32&&n<=35?3:0:7},J:function(){var n=isNullOrUndefined(this.E),t=!n&&this.E.a();return Diag.a.a(36227294,0,50,"InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:{0} - sessionStateManager IsNullOrUndefined: {1}",t,n),t},bw:function(n){if(this.J()){if(_Ewa.j.e(n.Errors)||!n.Result){Diag.a.a(24417759,0,50,"GetCategoryFromServer failed, ignoring - server errors: {0}",n.Errors?n.Errors.join(","):"None");return}var t=n.Result;Diag.a.a(24417760,0,50,"Updating number format category cache, format index = {0}, category = {1}",t.Index,t.Category);this.bG(t.Index,t.Category);this.dY("isim1",new _Ewa.lY(t.Index,t.Category),this)}},v:function(n){for(var i=new($$sc.v.$$(Number)),r=this.K.$$ge(),t;r.$$mn();)t=r.$$cu(),t.a===n&&i.b(t.b);return i.g()},bG:function(n,t){this.K.b(n,t)},t:function(n){return _Ewa.w.a(this.P,n,null)},u:function(n){var t,i,r;return(r=this.U.e(n,i={val:t},null),t=i.val,r)?t:null},dispose:function(){var t,i,n;for(System.a.a(this.L),this.L=null,this.bj(),t=this.I.$$ge();t.$$mn();)(i=t.$$cu(),n=i.a,!n||n.b>3)||Common.a.e.b(n.d);this.I=null;this.E&&(this.E.i(this.Y),this.H&&this.E.w(this.T),this.H=!1,this.E.s(this.Z));this.E=null;this.D&&_Ewa.c.a(this.D)&&_Ewa.c.a(this.D).a()&&(_Ewa.c.a(this.D).a().x(this.W),this.D.E(this.ba));this.D=null;_Ewa.bV.prototype.dispose.call(this)},w:function(n){try{switch(n){case"LocaleLongDateFormat":return _Ewa.a.a(228);case"GetLocaleDayNames":return _Ewa.a.a(229);case"CalculateTextWidthIgnoreLetterSpacing":return _Ewa.a.a(325);case"OfficeVSO:3657744_CalcFixForDateFormat":return _Ewa.a.b("OfficeVSO:3657744_CalcFixForDateFormat");case"OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return _Ewa.a.b("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case"CalcAutocompleteExperiment":return _Ewa.a.a(933);case"CalcNewFunctions":return _Ewa.a.a(282);case"CalcContractChecks":return _Ewa.a.a(283);case"CalcSupportDynamicArrays":return _Ewa.a.a(284);case"CalcFormatCalculations":return _Ewa.a.a(285);case"CalcFormulaCacheAPIChanges":return _Ewa.a.a(286);case"CalcStrictFormulaChecking":return _Ewa.a.a(287);case"CalcSupportStructuredReference":return _Ewa.a.a(299);case"CalcSupportRowReference":return _Ewa.a.a(300);case"CalcParserUsesPledges":return _Ewa.a.a(353);case"CalcWebWorker":return!0;case"CalcWebWorkerTest":return _Ewa.a.a(352);case"CalcLookupFunctions":return _Ewa.a.a(354);case"CalcLogStopWatch":return _Ewa.a.a(459);case"CalcPreventSpillingHack":return _Ewa.a.a(288);case"CalcDynamicArrayOperators":return _Ewa.a.a(108);case"CalcDotOperator":return _Ewa.a.a(797);case"CalcNumFmtPhaseOne":return _Ewa.a.a(795);case"CalcNumFmtPhaseTwo":return _Ewa.a.a(796);case"CalcStructuredReferences":return _Ewa.a.a(798);case"CalcUseTypedWorkersLib":return _Ewa.a.a(965);case"CalcLetFunction":return _Ewa.a.a(1061);default:return n.startsWith("OfficeVSO:")?_Ewa.a.b(n):!1}}catch(t){return Diag.a.a(22374148,0,15,"InstantaneousSupportInformation.IsFeatureEnabled({0}): feature parsing failed, returning false. Exception: {1}.",n,t.toString()),!1}},M:function(n){if(!this.J()||!this.E.c().g()){Diag.a.a(36227295,0,50,"InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits {0}, IsEditMode {1}",this.E.c().g(),this.D.b().C());return}System.a.a(this.L);this.L=null;this.L=_Ewa.B.a().a(this.bi,n,_Ewa.o.bA,!0,!1)},bF:function(){if(Diag.a.a(36227296,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh"),this.bj(),this.J()&&this.E.c().g()){_Ewa.a.b("OfficeVSO:5145683_SupportInfoManagerRefreshLog")||Diag.a.a(574424163,0,50,"InstantaneousSupportInformationManager.Refresh: waitingForStateIdChange:{0}, lastInstantaneousSupportInformationResult={1}, stateId={2}, lastStateId={3}",this.H,this.C?"not null":"null",this.E.d(),this.O);var n;n=_Ewa.p.r(this.D,"OfficeVSO:4764692_SupportInformationManagerRefreshFix")?!this.H&&(!this.C||this.E.bV()>this.O):!this.H&&(!this.C||this.E.d()>this.O);n?(Diag.a.a(34719488,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.Q=_Ewa.MK.a(this.D.c().a(),this.C?this.C.Digest:"",this.bg,this.bf,null,null,null)):this.V();Diag.a.a(34719489,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info.");this.bl()}},bl:function(){if(Diag.a.a(34719490,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called."),this.G){Diag.a.a(34719491,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping.");return}if(!this.J()){Diag.a.a(37089857,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.");return}if(!this.F||!this.F.length){var n={};n.FilterType=0;this.G=_Ewa.k.c(this.D.c().a(),n,this.be,this.X,null,null,null)}},bx:function(n){Diag.a.a(34719492,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = {0}, HTTP status = {1}.",n.b.c,n.b.a);this.G=null},bB:function(){this.H=!1;this.E.w(this.T);this.M(this.R?1e3:3e5)},bC:function(n,t){Diag.a.a(37492506,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");_Ewa.mZ.a(t)&&this.M(1e3)},bD:function(){Diag.a.a(40703904,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");this.D.k().CalcMode!==3&&(this.N=!this.D.k().CalcMode)},bE:function(){Diag.a.a(37492507,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.M(1e3);_Ewa.a.a(348)&&this.D.k().CalcMode!==3&&(this.N=!this.D.k().CalcMode)},by:function(n,t,i){if(Diag.a.a(34719493,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called."),this.G=null,!this.J()){Diag.a.a(34719494,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.");return}if(n.StateId===-1){Diag.a.a(34719495,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session.");this.V();return}!n.Result||this.F&&this.F.length?this.M(3e5):this.bm(n,t,i)},bm:function(n){var i,t;if(this.F=n.Result,Diag.a.a(34719496,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned {0} functions.",this.F?this.F.length:-1),i=!1,this.F){for(var u=this.F,f=u.length,r=0;r<f;++r)(t=u[r],t)&&(this.P[t.NameUI.toLocaleUpperCase()]=t.FunctionIndex.toString(),t.NameUI!==t.NameDataStrings&&(this.P[t.NameDataStrings.toLocaleUpperCase()]=t.FunctionIndex.toString(),i=!0),this.U.b(t.FunctionIndex,t.NameUI));this.dY("isim2",Sys.EventArgs.Empty,this)}i&&Diag.a.a(36569610,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")},bA:function(n){var e,o,r,t,i,f;if(this.J()){if(e=this.D,Diag.a.b(21311552,0,!!e,"null ewaControl"),this.R=!1,this.O=n.StateId,this.O===-1){this.R=!0;this.V();return}if(n.Result){if(o=n.Result,r=this.C,this.C=o,Diag.a.a(21311553,0,50,"InstantaneousSupportInformation updated, new result digest: {0}.",this.C.Digest),t=[],r)t=_Ewa.InstantaneousSupportInformationManager.c(r.NumberFormats,this.C.NumberFormats);else for(i=0;i<this.C.NumberFormats.length;i++)this.K.b(i,this.C.NumberFormats[i].NumberFormatCategory);for(var s=t,h=s.length,u=0;u<h;++u)f=s[u],this.K.b(f,this.C.NumberFormats[f].NumberFormatCategory);this.bH(t);this.dY("isim0",new _Ewa.Ts(t),this)}this.M(3e5)}},V:function(){this.H||(this.H=!0,this.E.x(this.T))},bz:function(n){if(this.J()){if(n.b.c===10){Diag.a.a(21311554,0,50,"Instantaneous support information request cancelled.");return}Diag.a.a(21311555,0,10,"Failed to update instantaneous support information, status = {0}, HTTP status = {1}.",n.b.c,n.b.a);this.R=!0;this.V()}},bj:function(){this.bn(this.Q);this.bn(this.G);this.Q=null;this.G=null},bn:function(n){!n||n.b>3||this.D.c().a().d(n.d)},bH:function(n){var t,i,r,u,e;if(this.S)n.length>0&&(Diag.a.a(22374147,0,50,"InstantaneousSupportInformation: Updating number formatting calculator formats. IFMTs to update: {0}",n.toString()),e=this.bk(n),this.S.updateFormats(e,!0));else{Diag.a.a(22374146,0,50,"InstantaneousSupportInformation: Creating number formatting calculator");t=this.bp();i=this.bk(null);try{r=new _Ewa.sT;u=this;this.S=numFmtCalc.initializeNumberFormatingCalculator(r,t,i,function(n){return u.w(n)},this.D)}catch(f){Diag.a.a(24379932,0,10,"NumberFormattingCalculator creation failed, exception = {0}. Stack error = {1}",f,f.stack)}}},bk:function(n){var h=this.C.NumberFormats.length,r=null,f,e,o,t,i;if(n){h=n.length;r=new($$sc.s.$$(Number));for(var c=n,a=c.length,u=0;u<a;++u)f=c[u],r.b(f,f)}e=new Array(h);this.bb=this.bq();this.bc=this.br();o=0;for(var l=this.C.NumberFormats,v=l.length,s=0;s<v;++s)(t=l[s],!r||r.c(t.IfmtIndex))&&(i={},i.index=t.IfmtIndex,i.formatString=" "+this.bo(t.FormatString),i.isPredefined=t.Builtin,e[o]=i,++o);return e},bo:function(n){var o=this.bu(n),u=o?this.bb:this.bc,f,r,t,e,i,s;if(Common.D.a(u))return n;for(f=new Sys.StringBuilder,r=!1,t=0;t<n.length;t++)e=!1,i=n.charAt(t).toString(),_Ewa.f.b(i,'"',!1)?r=!r:e=i in u,s=o||_Ewa.InstantaneousSupportInformationManager.d(n,t),f.append(e&&!r&&s?u[i]:i);return f.toString()},br:function(){var n={};return _Ewa.InstantaneousSupportInformationManager.a(n,this.C.LocaleInformation.ThousandSeparator.toString(),","),_Ewa.InstantaneousSupportInformationManager.a(n,this.C.LocaleInformation.DecimalSeparator.toString(),"."),n},bq:function(){var n={};return isNullOrUndefined(this.C.LocaleInformation.DayIndicator)||isNullOrUndefined(this.C.LocaleInformation.MonthIndicator)||isNullOrUndefined(this.C.LocaleInformation.YearIndicator)||(_Ewa.InstantaneousSupportInformationManager.a(n,this.C.LocaleInformation.DayIndicator.toString(),"d"),_Ewa.InstantaneousSupportInformationManager.a(n,this.C.LocaleInformation.MonthIndicator.toString(),"m"),_Ewa.InstantaneousSupportInformationManager.a(n,this.C.LocaleInformation.YearIndicator.toString(),"y")),_Ewa.InstantaneousSupportInformationManager.a(n,this.C.LocaleInformation.DateAlternativeSeparator.toString(),"-"),_Ewa.InstantaneousSupportInformationManager.a(n,this.C.LocaleInformation.DateSeparator.toString(),"/"),n},bu:function(n){return n.indexOf(this.C.LocaleInformation.DayIndicator)>-1||n.indexOf(this.C.LocaleInformation.MonthIndicator)>-1||n.indexOf(this.C.LocaleInformation.YearIndicator)>-1},bp:function(){var n={};n.lcid=this.C.LocaleInformation.Lcid;n.amAlternativeString=this.C.LocaleInformation.AmAltString;n.amPmSeparatedBySpace=this.C.LocaleInformation.AmPmSeparatedBySpace;n.amString=this.C.LocaleInformation.AmString;n.currencyAlternativeString="";n.currencyFormat=this.C.LocaleInformation.CurrencyFormat;n.currencySeparatedBySpace=this.C.LocaleInformation.CurrencySeparatedBySpace;n.currencyString="";n.dateAlternativeSeparator=this.C.LocaleInformation.DateAlternativeSeparator.toString();n.dateOrder=this.C.LocaleInformation.DateOrder;n.dateSeparator=this.C.LocaleInformation.DateSeparator.toString();n.decimalSeparator=this.C.LocaleInformation.DecimalSeparator.toString();n.digitsCurrency=this.C.LocaleInformation.DigitsCurrency;n.digitsNumber=this.C.LocaleInformation.DigitsNumber;n.expSeparatedBySpace=this.C.LocaleInformation.ExpSeparatedBySpace;n.fractionSeparator=this.C.LocaleInformation.FractionSeparator.toString();n.hour2Digits=this.C.LocaleInformation.Hour2Digits;n.longDateFormat=this.C.LocaleInformation.LongDateFormat;n.month2Digits=this.C.LocaleInformation.Month2Digits;n.percentSeparatedBySpace=this.C.LocaleInformation.PercentSeparatedBySpace;n.pmString=this.C.LocaleInformation.PmString;n.pmAlternativeString=this.C.LocaleInformation.PmAltString;n.thousandSeparator=this.C.LocaleInformation.ThousandSeparator.toString();n.timeSeparator=this.C.LocaleInformation.TimeSeparator.toString();n.use24HourClock=this.C.LocaleInformation.Use24HourClock;n.year4Digits=this.C.LocaleInformation.Year4Digits;n.listSeparator=this.C.LocaleInformation.ListSeparator.toString();n.columnSeparator=this.C.LocaleInformation.ColumnSeparator.toString();n.rowSeparator=this.C.LocaleInformation.RowSeparator.toString();n.trueValueString=this.C.LocaleInformation.TrueValueString;n.falseValueString=this.C.LocaleInformation.FalseValueString;var t=!isNullOrUndefined(this.C.LocaleInformation.DayIndicator),i=!isNullOrUndefined(this.C.LocaleInformation.MonthIndicator),r=!isNullOrUndefined(this.C.LocaleInformation.YearIndicator);return t&&i&&r?(n.dayIndicator=this.C.LocaleInformation.DayIndicator.toString(),n.monthIndicator=this.C.LocaleInformation.MonthIndicator.toString(),n.yearIndicator=this.C.LocaleInformation.YearIndicator.toString()):Diag.a.a(34349726,0,15,"Date indicators not initialized: DayIndicator is {0}, MonthIndicator is {1}, YearIndicator is {2}",t?"not null":"null",i?"not null":"null",r?"not null":"null"),n}};_Ewa.InstantaneousSupportInformationManager.b=function(n){this.a=n};_Ewa.InstantaneousSupportInformationManager.b.prototype={a:null};_Ewa.bjs=function(){};_Ewa.bjs.a=function(){_Ewa.l.a(_Ewa.yw.a)};_Ewa.yw=function(n){_Ewa.yw.initializeBase(this);this.i=n;this.l()};_Ewa.yw.a=function(n){if(!n)throw Error.argumentNull("ewaControl");n.a().b(_Ewa.bjT.$$(_Ewa.cV),246,new _Ewa.yw(n))};_Ewa.yw.prototype={i:null,b:function(){if(this.i){Diag.a.a(35985040,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var n=this;_Ewa.g.a(_Ewa.t.c(46,4,this.j,!1,!1,246),function(){n.k(n.i.a().a(_Ewa.cV,268,!1,null)||new _Ewa.InstantaneousSupportInformationManager(n.i.b(),n.i))},this.h(),3,null,null)}}};_Ewa.InstantaneousSupportInformationManager.registerClass("_Ewa.InstantaneousSupportInformationManager",_Ewa.bV,_Ewa.cV,Sys.IDisposable);_Ewa.InstantaneousSupportInformationManager.b.registerClass("_Ewa.InstantaneousSupportInformationManager.b");_Ewa.yw.registerClass("_Ewa.yw",_Ewa.sr.$$(_Ewa.cV));_Ewa.bjs.a();Type.registerNamespace("_Ewa");_Ewa.dt=function(n){this.z=Function.createDelegate(this,this.M);this.y=Function.createDelegate(this,this.bk);this.r=-1;this.t=-1;this.s=-1;this.q=-1;this.a=-1;this.e=-1;this.d=n;this.x=this.d?n.e().CalcWebWorkerSmokeTestPingIntervalMS:this.x;this.c=new($$sc.s.$$(_Ewa.dt.d));this.i=null;this.O()};_Ewa.dt.k=function(n){var r=[],t,i,u;if(n&&n.a)for(t=n.a.$$ge();t.$$mn();)i=t.$$cu(),u=excelOnlineCalc.calc.columnData(i.b,i.a),Array.add(r,u);return r};_Ewa.dt.l=function(n,t){var u,i,r,f,e;if(n.c!==t.c||n.d!==t.d||!_Ewa.f.b(n.e,t.e,!1)||!n.b.g(t.b))return!1;if(!n.a&&!t.a)return!0;if(!n.a||!t.a||n.a.a.f!==t.a.a.f)return!1;for(u=n.a.a.$$ge();u.$$mn();)if(i=u.$$cu(),!i.a||!(e=t.a.a.e(i.b,f={val:r},null),r=f.val,e)||!r||!_Ewa.f.b(i.a,r,!1))return!1;return!0};_Ewa.dt.c=function(n,t,i){var u=_Ewa.dt.a("NamedObject",t.f,t.b.a-1,t.b.b-1,t.b.d-1,t.b.c-1),r,f;if(t.c===2){var e=!!(t.d&16),o=!!(t.d&8),s=_Ewa.dt.k(t.a),h=excelOnlineCalc.calc.namedTableData(u,e,o,s);r=excelOnlineCalc.calc.namedObject(n,h)}else f=excelOnlineCalc.calc.namedRangeData(u),r=excelOnlineCalc.calc.namedObject(n,f);Array.add(i,r)};_Ewa.dt.f=function(n){var t=Sys.Serialization.JavaScriptSerializer.serialize(n.getRowNumbers()),i=Sys.Serialization.JavaScriptSerializer.serialize(n.getColumnNumbers());return t+i};_Ewa.dt.b=function(n){var i=null,t,r;if(n.length>1)for(t=1;t<n.length;t++)for(r=0;n[t-1]+1+r<n[t];)i=i||[],Array.add(i,n[t-1]+r),r++;return i};_Ewa.dt.e=function(n,t){if(!t)return null;for(var i=0,r=t.length;i<r;++i)if(_Ewa.f.b(n,t[i].Name,!1))return t[i];return null};_Ewa.dt.a=function(n,t,i,r,u,f){var e=function(n,t,i,r){(i<0||i>=r)&&Diag.a.a(591204771,0,15,"CalcAsyncEngine::CreateSheetRangeLocation() callerId:{0} invalid {1}:{2}",n,t,i)};return isNullOrUndefined(t)&&Diag.a.a(591189920,0,15,"CalcAsyncEngine::CreateSheetRangeLocation() callerId:{0} sheetId is null",n),e(n,"top",i,1048576),e(n,"left",r,16384),e(n,"bottom",u,1048576),e(n,"right",f,16384),excelOnlineCalc.calc.sheetRangeLocation(t,i,r,u,f)};_Ewa.dt.prototype={d:null,x:500,w:null,p:!1,v:!1,o:!1,u:0,k:"TRUE",m:"FALSE",j:null,f:null,b:null,h:"",i:null,g:null,c:null,dispose:function(){this.b&&this.b.g(this.y);_Ewa.a.b("OfficeVSO:4895398_RestartUnresponsiveWorkerThread")&&this.d&&this.d.E(this.z);this.X()},D:function(n){if(!this.f)return!1;if(!this.b&&(this.b=this.d.a().a(_Ewa.cV,268,!1,null),!this.b))return Diag.a.a(42812304,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;if(n!==2&&(this.a=this.d.y().bV(),this.a===-1&&(this.a=this.d.y().d())),n===1&&this.a<this.e)return Diag.a.a(591680646,0,50,"CalcAsyncEngine::UpdateData() currentStateId:{0} < lastUpdatedStateId:{1} - ignoring update",this.a,this.e),!1;this.bo();n&&this.v||(this.bv(),this.bp(),this.br(),this.N(),this.b.k(this.y),this.d.D(this.z),this.v=!0);this.bm();var t=!1;return n||(t=this.bg()),(n||t)&&(this.bs()?(this.bu(n),this.bt(),this.e=this.a,this.V()):Diag.a.a(595072545,0,15,"CalcAsyncEngine::UpdateData() for StateId:{0} failed - no Sheets information",this.a)),n!==2&&this.C(),!0},bc:function(n){if(!this.f)return Diag.a.a(590956100,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});var t=this.f.evalFormula(this.d.y().d(),n,_Ewa.C.a(this.d.d().a()));return this.C(),t},U:function(n,t,i,r,u){var o,l,p,s,e;if(!this.f||!n){Diag.a.a(51513233,0,15,"CalcAsyncEngine::CalculateFormula() recalc engine is null:{0}, modifiedCell is null:{1}",!this.f,!n);return}var a=_Ewa.C.a(this.d.d().a()),h=n.a().h()-1,c=n.a().g()-1,w=h,b=c,v=null;if(u&&(v=excelOnlineCalc.calc.cellLocation(h,c),h=u.a-1,c=u.b-1,w=u.d-1,b=u.c-1),o=-1,n.a().c()){if(o=n.a().c().B(),o===-1){Diag.a.a(593503619,0,15,"CalcAsyncEngine::CalculateFormula() BlockRevision unknown for block:{0}",n.a().c().e());return}}else{Diag.a.a(593503618,0,15,"CalcAsyncEngine::CalculateFormula() GridBlockModelProxy is null cell:({0},{1})",n.a().h(),n.a().g());return}if(o<this.e){Diag.a.a(593503617,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < lastUpdatedStateId:{3}",h,c,o,this.e);return}if(o<this.a){Diag.a.a(591680645,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < currentStateId:{3}",h,c,o,this.a);return}if(this.p||(this.f.setOnRecalcResults(r),this.p=!0),this.bw()&&!this.D(2)){Diag.a.a(593503616,0,15,"CalcAsyncEngine.CalculateFormula: UpdateData failed");return}var k=this.d.a().a(_Ewa.cV,268,!1,null),y=_Ewa.dt.a("CalculateFormula.cell",a,h,c,w,b),d=[],g=_Ewa.c.a(this.d),f=g.r();_Ewa.c.a(this.d).f().c()&&(f=g.n(1).r(),f.bc(1,1),f.bc(3,1));l=_Ewa.dt.a("CalculateFormula.viewport",a,f.a-1,f.b-1,f.d-1,f.c-1);i?p=excelOnlineCalc.calc.inferredRangeFormulaEdit(y,t,v,l):(s=null,e=null,n.a().f().length?k&&k.m(n.a().bp())?(s=n.a().f(),e=this.L(n,t,s),e.startsWith("'")||(e="'"+e)):_Ewa.bB.b(n.a().f())&&t&&!t.startsWith("'")?(e=n.a().f(),s=null):(s=this.bd(n.a().f()),e=this.L(n,t,s)):(s=excelOnlineCalc.calc.blankValue,e=""),p=isNull(s)?excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(y,e,v,l):excelOnlineCalc.calc.valueRangeFormulaEdit(y,e,s,l));Array.add(d,p);Diag.a.a(51513232,0,50,"CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",a,h,c,_Ewa.f.q(n.a().f()),o,f.a-1,f.b-1,f.d-1,f.c-1);this.f.editRangeFormulas(o,d);this.C()},K:function(n){var i=null,f,e,r,t,u;try{if(!n){Diag.a.b(50671750,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null");return}if(this.h=_Ewa.c.a(this.d).b().bp(n),this.a=n.ba,this.a<this.e||this.a===-1){Diag.a.a(594884824,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:{0} blockRevision:{1} < lastUpdatedStateId:{2}",this.h,this.a,this.e);return}if(this.bi(),this.T(n))return;if(f=String.format("CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:{0} StateId:{1}",this.h,this.a),i=this.d.o().a("ModelUpdate",f),this.i=this.n(n.D.b()),!this.i){e=!!(this.d.r()&32);Diag.a.a(50671751,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets {0}, scratchPad:{1}, sheetNameLength:{2} Hash:{3}",!this.c.c(this.a)||!this.c.a(this.a).a?0:this.c.a(this.a).a.length,e,n.D.b()?n.D.b().length:-1,n.D.s());return}if(!_Ewa.c.a(this.d).b().x().c(n.w))return;if(r=n.b(),!r){Diag.a.a(50671752,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:{0}",this.h);return}if(t=r.getCalcBlockModel(_Ewa.a.b("OfficeVSO:4855360_FixAccountingInMergeCellsAcrossBlocks")),!t){Diag.a.a(50671753,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");return}if(!this.S(t))return;if(this.c.a(this.a).b[this.h]=new _Ewa.dt.i(t,n.D.b()),_Ewa.a.a(798)){if(u=n.q,!u){Diag.a.a(574682057,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null");return}this.E(u.NamedObjects)}else this.E(null)}finally{i&&i.a()}},bf:function(n){var t,i,r,u,f;if(!this.c.a(this.a).a||!this.c.a(this.a).a[0]||(t=this.c.a(this.a).a[0].a,!t||!(n.N in t))||(i=t[n.N],!i||!i.a))return null;for(r=new($$sc.v.$$(String)),u=i.a.a.$$ge();u.$$mn();)f=u.$$cu(),r.b(f.a);return r},L:function(n,t,i){return t&&t.startsWith("'")?t:n.a().bg()||i.toString()},bb:function(n,t,i){var r=null,u,e,f,o;this.G()&&this.c.a(this.e).b&&(u=this.c.a(this.e).b[n],u&&u.a&&(r=u.b));!r;e=this.bj(n,r,t,i);this.Z(r,t,e,o={val:f});f=o.val;Diag.a.a(50671754,0,50,"CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:{0} StateId:{1} number of formulas {2}",n,this.a,f)},bj:function(n,t,i,r){var u=!1,e=_Ewa.dt.f(i),f;return t&&(f=_Ewa.dt.f(t),_Ewa.f.b(f,e,!1)&&(u=!0)),u?this.P(t,this.e,r):this.R(i,r),u},G:function(){var n=!1;return this.f&&this.e!==-1&&(n=this.f.stateIdAvailable(this.e)),n&&this.c.c(this.e)&&this.e<this.a},Z:function(n,t,i,r){r.val=0;var u=null,f=null;for(t.reset();u=t.getNextCell();)_Ewa.bB.b(u.formula)&&r.val++,f=i?n.getCell(u.row,u.col):null,f?this.Y(t,u,f):this.Q(t,u);if(i)for(n.reset();f=n.getNextCell();)u=t.getCell(f.row,f.col),u||this.F(n,f)},br:function(){var n=this;this.f.setOnUpdateRequest(function(){})},bq:function(){var n=this;this.f.setOnUnresponsive(function(t,i,r,u){n.bl(t,i,r,u)})},bl:function(n,t,i,r){Diag.a.a(571245912,0,15,"CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:{0}, waitTime:{1}, timeoutCount:{2}, hasBeenClosed:{3}.",n,t,i,r);r&&(this.bn(),this.O())},bn:function(){this.M(null,null);this.p=!1;this.o=!1;this.u=0;this.r=-1;this.t=-1;this.s=-1;this.q=-1},X:function(){this.f.close()},W:function(){this.f.clearCache()},C:function(){this.f.resumeRecalc()},bd:function(n){var r,i,t,u,f;if(this.b){if(r=this.b.c(),i=r.toNumber(n),!isNaN(i))return i;if(n.toUpperCase()===this.k||n.toUpperCase()===this.m)return n.toUpperCase()===this.k;if(!n.length)return excelOnlineCalc.calc.blankValue;if(t=-1,f=this.be(n,u={val:t}),t=u.val,f)return excelOnlineCalc.calc.errorValue(t)}return n},bp:function(){this.f.setA1ReferenceStyle(!0)},bm:function(){var t,e,o,s,h;if(this.b){var i=this.b.p(),r=this.b.s(),u=this.b.r(),f=this.b.q(),n=!1;i!==this.r&&(n=!0,this.r=i);r!==this.t&&(n=!0,this.t=r);u!==this.s&&(n=!0,this.s=u);f!==this.q&&(n=!0,this.q=f);t=[];_Ewa.a.a(746)&&(e=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",null),t.push(e),n=!0);_Ewa.a.a(793)&&(o=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),t.push(o),n=!0);_Ewa.a.a(933)&&(s=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),t.push(s),n=!0);n&&(h=excelOnlineCalc.calc.recalcServiceConfig(null,i,null,r,null,null,null,u,t,f),this.f.reconfigure(h))}},bu:function(n){var t=null,i,r;if(!this.c.c(this.a)){Diag.a.a(595072542,0,15,"CalcAsyncEngine::SetUpdatedRanges StateId:{0} does not exist in GridCache",this.a);return}try{this.g=[];i=String.format("CalcAsyncEngine::SetUpdatedRanges() StateId:{0} UpdateTriggerData:{1}",this.a,_Ewa.dt.h.toString(n));t=this.d.o().a("ModelUpdate",i);r=this;Common.D.b(this.c.a(this.a).b,function(n,t){t.a||(r.bb(n,t.b,t.c),t.a=!0)},null);this.f.updateRanges(this.a,this.g)}finally{t&&t.a()}},bt:function(){var t=[],r=_Ewa.a.a(798)?this.G():!1,u,n,i,f;for(_Ewa.a.a(798)?(u=r&&this.c.a(this.e).a&&this.c.a(this.e).a[0]&&this.c.a(this.e).a[0].c?this.c.a(this.e).a[0].a:null,this.H(u,this.c.a(this.a).a[0].a,null,this.e,t),this.c.a(this.a).a[0].c=!0):this.J(this.c.a(this.a).a[0].a,null,t),n=1;n<this.c.a(this.a).a.length;n++)_Ewa.a.a(798)?(i=-1,r&&this.c.a(this.e).a&&(i=this.A(this.c.a(this.a).a[n].b.sheetName,this.e)),f=i!==-1&&this.c.a(this.e).a[i].c?this.c.a(this.e).a[i].a:null,this.H(f,this.c.a(this.a).a[n].a,this.c.a(this.a).a[n].b.sheetId,this.e,t),this.c.a(this.a).a[n].c=!0):this.J(this.c.a(this.a).a[n].a,this.c.a(this.a).a[n].b.sheetId,t);this.f.updateNamedObjects(this.a,t)},J:function(n,t,i){var r=null,u,f;isNullOrUndefined(t)||(r=excelOnlineCalc.calc.undefinedNamesWrite(t),Array.add(i,r));n&&(u=[],f=this,Common.D.b(n,function(n,t){Array.add(u,t)},null),r=excelOnlineCalc.calc.namedObjectsWrite(t,u),Array.add(i,r))},H:function(n,t,i,r,u){var s,f,y,h,p,w,l,a,v;if(isNullOrUndefined(i)||(s=excelOnlineCalc.calc.undefinedNamesWrite(i),Array.add(u,s)),!n){t&&(f=[],y=this,Common.D.b(t,function(n,t){_Ewa.dt.c(n,t,f)},null),f.length>0&&(h=excelOnlineCalc.calc.namedObjectsWrite(i,f),Array.add(u,h)));return}var c=!1,e=[],o=[];t&&(p=this,Common.D.b(t,function(t,i){var r=i,u,f;t in n?(u=n[t],_Ewa.dt.l(u,r)?c=!0:(f=excelOnlineCalc.calc.namedObject(t,null),Array.add(e,f),_Ewa.dt.c(t,r,o))):_Ewa.dt.c(t,r,o)},null));w=this;Common.D.b(n,function(n,i){var u=i,r;t&&n in t||(r=excelOnlineCalc.calc.namedObject(n,null),Array.add(e,r))},null);c&&(l=excelOnlineCalc.calc.namedObjectsPromote(i,r),Array.add(u,l));e.length>0&&(a=excelOnlineCalc.calc.namedObjectsWrite(i,e),Array.add(u,a));o.length>0&&(v=excelOnlineCalc.calc.namedObjectsWrite(i,o),Array.add(u,v))},T:function(){return this.c.a(this.a).b[this.h]?(Diag.a.a(50671763,0,50,"CalcAsyncEngine::BlockPreviouslyHandled Block Hash:{0} StateId:{1} previously handled",this.h,this.a),!0):!1},S:function(n){return n.getColumnNumbers().length===1&&n.getColumnNumbers()[0]===16385?!1:!0},bg:function(){var n=!1,t=this;return _Ewa.c.a(this.d).b().bf(function(i){i.r&1&&t.d.b().d()===i.q.Information.Revision&&(t.K(i),n=!0)}),n},I:function(n,t){var i=n.getRowNumbers(),r=n.getColumnNumbers(),f=i[0]-1,e=i[i.length-1]-1,o=r[0]-1,s=r[r.length-1]-1,u=this.n(t);return u||Diag.a.a(594581026,0,15,"CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets {0}",!this.c.c(this.a)||!this.c.a(this.a).a?0:this.c.a(this.a).a.length),_Ewa.dt.a("CreateBlockRangeLocation",u,f,o,e,s)},P:function(n,t,i){var r=this.I(n,i);if(r){var u=_Ewa.dt.b(n.getRowNumbers()),f=_Ewa.dt.b(n.getColumnNumbers()),e=excelOnlineCalc.calc.rangePromote(r,t,u,f);this.g[this.g.length]=e}},R:function(n,t){var i=this.I(n,t);if(i){var r=_Ewa.dt.b(n.getRowNumbers()),u=_Ewa.dt.b(n.getColumnNumbers()),f=excelOnlineCalc.calc.rangeWrite(i,null,r,u);this.g[this.g.length]=f}},Y:function(n,t,i){var u=null,f=0,e=0,r=!1,o=null,s,h;switch(t.valueType){case 2:u=this.B(t);o=this.B(i);r=_Ewa.f.b(o,u,!1);break;case 1:isNull(t.value)&&isNull(i.value)?r=!0:(f=parseFloat(t.value),s=parseFloat(i.value),r=s===f);break;default:isNull(t.value)&&isNull(i.value)?r=!0:(e=parseFloat(t.value),h=parseFloat(i.value),r=e===h)}r&&t.valueType===i.valueType&&t.ifmt===i.ifmt&&t.formulaType===i.formulaType&&_Ewa.f.b(i.formula,t.formula,!1)||(isNullOrUndefined(t.formula)&&isNullOrUndefined(t.value)&&isNullOrUndefined(t.text)?this.F(n,t):this.l(n,t,u,f,e))},E:function(n){var s,t,u,f,r,l,a,v,o,p,w,e;if(this.d.n()&&this.d.n().j())for(s=0;s<this.d.n().e();s++)if(t=this.d.n().j()[s],t.Q===2||t.Q===3){var h=0,i=t.N,c=i.lastIndexOf("!");if(c>0){if(u=i.substr(0,c),u.charAt(0)==="'"&&(u=u.substr(1,u.length-2)),h=this.A(u,this.a),h===-1){Diag.a.a(595096334,0,15,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets {0}",!this.c.c(this.a)||!this.c.a(this.a).a?0:this.c.a(this.a).a.length);continue}i=i.substr(c+1)}if(f=this.c.a(this.a).a[h].a,_Ewa.a.a(798))if(r=null,i in f){if(r=f[i],r.c===2&&(o=_Ewa.dt.e(t.N,n),o))if(r.a){if(o.ColHeadersList)for(var b=o.ColHeadersList.HeadersList,k=b.length,y=0;y<k;++y)p=b[y],r.a.a.b(p.Index,p.Name)}else r.a=new _Ewa.vi(o.ColHeadersList)}else{if(l=t.O,t.Q===2&&(l=_Ewa.bE.a(t,!1)),a=this.n(t.P),!a){Diag.a.a(574682056,0,15,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets {0}",!this.c.c(this.a)||!this.c.a(this.a).a?0:this.c.a(this.a).a.length);continue}r=new _Ewa.dt.j(t.Q,t.N,l,a,t.S);r.c===2&&(v=_Ewa.dt.e(t.N,n),v&&(r.a=new _Ewa.vi(v.ColHeadersList)));f[i]=r}else if(!(i in f)){if(w=this.n(t.P),!w){Diag.a.a(595096333,0,15,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets {0}",!this.c.c(this.a)||!this.c.a(this.a).a?0:this.c.a(this.a).a.length);continue}e=t.O;t.Q===2&&(e=_Ewa.bE.a(t,!1));var d=_Ewa.dt.a("NamedObject",w,e.a-1,e.b-1,e.d-1,e.c-1),g=excelOnlineCalc.calc.namedRangeData(d),nt=excelOnlineCalc.calc.namedObject(i,g);f[i]=nt}}},l:function(n,t,i,r,u){var l=n.getRowNumbers()[t.row]-1,a=n.getColumnNumbers()[t.col]-1,y=_Ewa.dt.a("AddRangeUpdateCommand",this.i,l,a,l,a),f=null,e=t.formula||t.text,o=excelOnlineCalc.calc.blankValue,s=null,h,c,v;isNullOrUndefined(t.text)&&isNullOrUndefined(t.value)&&(i="",s="This cell contains blanks only",t.formulaType||(e=""));switch(t.valueType){case 2:isNull(i)||(t.formulaType||(f=excelOnlineCalc.calc.valueCellData(e,i,t.ifmt,s)),t.formulaType===1&&(f=excelOnlineCalc.calc.cellFormulaCellData(e,i,t.ifmt,s)),t.formulaType===2&&(f=excelOnlineCalc.calc.valueCellData("",o,0,"This cell is a part of an array")));break;case 1:isNaN(r)?Diag.a.a(50857250,0,50,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid numeric value",t.row,t.col):(t.formulaType||(f=excelOnlineCalc.calc.valueCellData(e,r,t.ifmt,null)),t.formulaType===1&&(f=excelOnlineCalc.calc.cellFormulaCellData(e,r,t.ifmt,null)),t.formulaType===2&&(f=excelOnlineCalc.calc.valueCellData("",o,0,"This cell is a part of an array")));break;case 3:isNaN(u)?Diag.a.a(50857251,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid boolean value",t.row,t.col):(h=u===1?!0:!1,t.formulaType||(f=excelOnlineCalc.calc.valueCellData(e,h,t.ifmt,null)),t.formulaType===1&&(f=excelOnlineCalc.calc.cellFormulaCellData(e,h,t.ifmt,null)),t.formulaType===2&&(f=excelOnlineCalc.calc.valueCellData("",o,0,"This cell is a part of an array")));break;case 4:isNaN(u)?Diag.a.a(50857280,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid error value",t.row,t.col):(c=excelOnlineCalc.calc.errorValue(u),t.formulaType||(f=excelOnlineCalc.calc.valueCellData(e,c,t.ifmt,null)),t.formulaType===1&&(f=excelOnlineCalc.calc.cellFormulaCellData(e,c,t.ifmt,null)),t.formulaType===2&&(f=excelOnlineCalc.calc.valueCellData("",o,0,"This cell is a part of an array")));break;default:f=excelOnlineCalc.calc.valueCellData("",o,t.ifmt,null)}f&&(v=excelOnlineCalc.calc.rangeWrite(y,f,null,null),this.g[this.g.length]=v)},Q:function(n,t){switch(t.valueType){case 2:var i=this.B(t);this.l(n,t,i,null,0);break;case 1:this.l(n,t,null,parseFloat(t.value),0);break;default:this.l(n,t,null,null,parseFloat(t.value))}},F:function(n,t){var i=n.getRowNumbers()[t.row]-1,r=n.getColumnNumbers()[t.col]-1,u=_Ewa.dt.a("AddRangeUpdateCommandEmptyCell",this.i,i,r,i,r),f=excelOnlineCalc.calc.blankValue,e=excelOnlineCalc.calc.valueCellData("",f,t.ifmt,null),o=excelOnlineCalc.calc.rangeWrite(u,e,null,null);this.g[this.g.length]=o},n:function(n){var t=this.A(n,this.a);return t>0?this.c.a(this.a).a[t].b.sheetId:null},A:function(n,t){var r,i;if(!this.c.c(t))return Diag.a.a(595072538,0,15,"CalcAsyncEngine.GetSheetInternalIndex StateId:{0} does not exist in GridCache",t),-1;if(!this.c.a(t).a)return Diag.a.a(595072537,0,15,"CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:{0}",t),-1;for(r=this.c.a(t).a,i=1;i<r.length;i++)if(_Ewa.f.b(r[i].b.sheetName,n,!1))return i;return-1},bs:function(){var t,n,i;if(!this.c.c(this.a)||!this.c.a(this.a).a.length)return Diag.a.a(595072536,0,15,"CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:{0} or StateId does not exist in GridCache",this.a),!1;for(t=[],n=1;n<this.c.a(this.a).a.length;n++)i=this.c.a(this.a).a[n],i&&Array.add(t,i.b);return this.f.updateSheetNames(this.a,t),this.f.updateUnusedCells(this.a,this.c.a(this.a).c),!0},N:function(){var t,n,u;if(this.b){t=[];for(var r=this.b.d(),f=r.length,i=0;i<f;++i)n=r[i],u=excelOnlineCalc.calc.numberFormat(n.IfmtIndex,n.FormatString,n.Builtin),Array.add(t,u);this.f.setNumberFormats(t,!0)}},bo:function(){var n,t;if(this.b&&this.b.a()&&(n=this.bh(),!this.o||n)){if(this.ba(),this.b.a().TrueValueString&&(this.k=this.b.a().TrueValueString),this.b.a().FalseValueString&&(this.m=this.b.a().FalseValueString),_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData"))t=_Ewa.gG.d(this.b,n);else{var i=this.b.a().DecimalSeparator.toString(),r=this.b.a().ListSeparator.toString(),u=this.b.a().ColumnSeparator.toString(),f=this.b.a().RowSeparator.toString(),e=this.b.a().ThousandsDataArray,o=this.b.a().ThousandSeparator.toString(),s=this.b.a().Lcid,h=this.b.a().Country,c=this.b.a().DigitsNumber,l=this.b.a().ExpSeparatedBySpace,a=this.b.a().FractionSeparator.toString(),v=this.b.a().PercentSeparatedBySpace,y=_Ewa.f.A(Enum.toString(_Ewa.tw,this.b.a().CurrencyFormat)),p=this.b.a().CurrencySymbolLead,w=this.b.a().CurrencySeparatedBySpace,b=this.b.a().CurrencySymbolString,k=this.b.a().DigitsCurrency,d=this.b.a().DateOrder,g=d===-1?"MDY":Enum.toString(_Ewa.tx,this.b.a().DateOrder).toUpperCase(),nt=this.b.a().DateSeparator.toString(),tt=this.b.a().DateAlternativeSeparator.toString(),it=this.b.a().Year4Digits,rt=this.b.a().Month2Digits,ut=this.b.a().Day2Digits,ft=this.b.a().LongDateFormat,et=this.b.a().TimeSeparator.toString(),ot=this.b.a().TimeAltSeparator==null?null:this.b.a().TimeAltSeparator.toString(),st=this.b.a().Hour2Digits,ht=this.b.a().Use24HourClock,ct=this.b.a().AmPmSeparatedBySpace,lt=[this.b.a().AmString,this.b.a().PmString],at=this.b.a().DayNameShortArray,vt=this.b.a().DayNameLongArray,yt=this.b.a().MonthNameShortArray,pt=this.b.a().MonthNameLongArray,wt=this.b.a().PictureSpecialArray,fi=this,bt=_Ewa.bt.c(("\x00"+this.b.a().PictureSingleString).split(""),function(n){return n==="\x00"?null:n}),kt=this.b.a().PictureColorArray,dt=this.b.a().PictureDbnumArray,gt=this.b.a().RowLetter.toString(),ni=this.b.a().ColumnLetter.toString(),ti=this.b.a().LeftBrace.toString(),ii=this.b.a().RightBrace.toString(),ri=this.b.a().LeftBracket.toString(),ui=this.b.a().RightBracket.toString();t=excelOnlineCalc.calc.localeData(n,this.j,this.k,this.m,gt,ni,ti,ii,ri,ui,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt)}this.f.setLocale(t);this.o=!0}},bv:function(){var i=3,r=null,n,t,u;isNullOrUndefined(this.d.k().TimeZoneInformation)?Diag.a.a(589088772,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null"):(n=null,this.d.k().TimeZoneInformation.StandardDate.Month&&(n=excelOnlineCalc.date.dateTime(this.d.k().TimeZoneInformation.StandardDate.Year,this.d.k().TimeZoneInformation.StandardDate.Month,this.d.k().TimeZoneInformation.StandardDate.Day,this.d.k().TimeZoneInformation.StandardDate.Hour,this.d.k().TimeZoneInformation.StandardDate.Minute,this.d.k().TimeZoneInformation.StandardDate.Second,this.d.k().TimeZoneInformation.StandardDate.DayOfWeek+1,this.d.k().TimeZoneInformation.StandardDate.Milliseconds,i)),t=null,this.d.k().TimeZoneInformation.DaylightDate.Month&&(t=excelOnlineCalc.date.dateTime(this.d.k().TimeZoneInformation.DaylightDate.Year,this.d.k().TimeZoneInformation.DaylightDate.Month,this.d.k().TimeZoneInformation.DaylightDate.Day,this.d.k().TimeZoneInformation.DaylightDate.Hour,this.d.k().TimeZoneInformation.DaylightDate.Minute,this.d.k().TimeZoneInformation.DaylightDate.Second,this.d.k().TimeZoneInformation.DaylightDate.DayOfWeek+1,this.d.k().TimeZoneInformation.DaylightDate.Milliseconds,i)),r=excelOnlineCalc.date.tzData(this.d.k().TimeZoneInformation.Bias,n,this.d.k().TimeZoneInformation.StandardBias,t,this.d.k().TimeZoneInformation.DaylightBias));u=excelOnlineCalc.calc.workbookProps(this.d.k().F1904,this.d.k().FDateCompatibility,r);this.f.setWorkbookProps(u)},bk:function(){this.N()},M:function(){Diag.a.a(595072535,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.c=new($$sc.s.$$(_Ewa.dt.d));this.e=-1;this.a=-1;this.h="";this.i=null;this.v=!1;this.f&&this.W()},O:function(){var t,r,i,n;_Ewa.a.a(352)&&(t=0,r=this,$$sc.h.a(Boolean,excelOnlineCalc.worker.runSmokeTest(1/t,this.x,!0)).CW(function(n){n.c?Diag.a.a(40768413,0,15,"CalcAsyncEngine.TryInitialize: calc smoke test failed: {0}",n.c.toString()):Diag.a.a(40768412,0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")}));i=_Ewa.a.a(941)?"Local":"Thread";this.w=$$sc.h.a(Object,excelOnlineCalc.calc.createRecalcService(i,_Ewa.a.a(916)));n=this;this.w.CW(function(t){if(t.c)Diag.a.a(42321621,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker failed: {0}",t.c.toString());else if(Diag.a.a(42321620,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),n.f=n.w.a(),n.f){if(!n.D(0)){Diag.a.a(594884823,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize");return}_Ewa.a.b("OfficeVSO:4895398_RestartUnresponsiveWorkerThread")&&n.bq()}else Diag.a.a(42812306,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null")})},bh:function(){var n=this.b.b();return!n||this.u===n.length?null:(this.u=n.length,_Ewa.gG.c(n))},ba:function(){this.j=_Ewa.gG.b()},be:function(n,t){t.val=0;for(var i=0;i<this.j.length;i++)if(this.j[i].errorName===n.toUpperCase())return t.val=this.j[i].errorType,!0;return!1},bi:function(){var i,t,n,u,r,f,e;if(!this.c.c(this.a)||!(this.c.a(this.a).a.length>0))for(this.c.b(this.a,new _Ewa.dt.d),this.c.a(this.a).a[0]=new _Ewa.dt.g(null),i=this.d.d(),t=0;t<i.e();t++)n=$$as(_Ewa.N,i.g(t)),n?((isNullOrUndefined(n.R)||isNullOrUndefined(n.N)||!n.R.length||!n.N.length)&&Diag.a.a(591189921,0,15,"CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:{0} Id:{1} Hash:{2} NameLength:{3}",t,n.R,n.bn,n.N?n.N.length:-1),u=excelOnlineCalc.calc.sheetName(n.R,n.N),this.c.a(this.a).a[t+1]=new _Ewa.dt.g(u),r=n.O.x(),f=excelOnlineCalc.calc.rangeLocation(0,0,r.LastRow,r.LastColumn),e=excelOnlineCalc.calc.unusedCellsUpdate(n.R,f),Array.add(this.c.a(this.a).c,e)):Diag.a.a(595072534,0,15,"CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:{0} sheet-index:{1}",this.a,t)},V:function(){for(var t=this.c.$$ge(),n;t.$$mn();)n=t.$$cu(),n.b<this.e&&this.c.i(n.b)},B:function(n){var t=n.value||n.text;return isNullOrUndefined(t)&&(t=""),t},bw:function(){if(!this.c.c(this.a))return!1;var n=!1,t=this;return Common.D.b(this.c.a(this.a).b,function(t,i){i.a||(n=!0)},null),n}};_Ewa.dt.h=function(){};_Ewa.dt.h.prototype={initialization:0,contentReady:1,cellEdit:2};_Ewa.dt.h.registerEnum("_Ewa.dt.h",!1);_Ewa.dt.d=function(){this.a=[];this.c=[];this.b={}};_Ewa.dt.d.prototype={a:null,c:null,b:null};_Ewa.dt.i=function(n,t){this.b=n;this.c=t;this.a=!1};_Ewa.dt.i.prototype={b:null,c:null,a:!1};_Ewa.dt.g=function(n){this.b=n;this.a={};this.c=!1};_Ewa.dt.g.prototype={b:null,a:null,c:!1};_Ewa.dt.j=function(n,t,i,r,u){this.c=n;this.e=t;this.b=i;this.f=r;this.d=u;this.a=null};_Ewa.dt.j.prototype={c:0,e:null,f:null,b:null,d:0,a:null};_Ewa.gG=function(n){var t;this.d=n;this.e=this.d.a().a(_Ewa.cV,268,!1,null);this.e||Diag.a.b(34719498,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");t=_Ewa.a.a(642)?_Ewa.t.b.a(54):_Ewa.t.b.a(57);this.h=new _Ewa.sT;this.g=excelOnlineCalc.location.documentLoc("",this.d.k().FullDocumentInfo.BreadcrumbDocName);this.a=new _Ewa.lU(n,this.e);var i=this,u=this,r=this.e?function(n){return i.e.w(n)}:function(){return!1};excelOnlineCalc.config.initCalc(this.h,r,t);this.c=excelOnlineCalc.config.calcConfig(this.a.b);_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")&&(this.b=excelOnlineCalc.config.calcConfig(this.a.a))};_Ewa.gG.d=function(n,t){var i=_Ewa.gG.b(),r=n.a().TrueValueString,u=n.a().FalseValueString,f=n.a().DecimalSeparator.toString(),e=n.a().ListSeparator.toString(),o=n.a().ColumnSeparator.toString(),s=n.a().RowSeparator.toString(),h=n.a().ThousandsDataArray,c=n.a().ThousandSeparator.toString(),l=n.a().Lcid,a=n.a().Country,v=n.a().DigitsNumber,y=n.a().ExpSeparatedBySpace,p=n.a().FractionSeparator.toString(),w=n.a().PercentSeparatedBySpace,b=_Ewa.f.A(Enum.toString(_Ewa.tw,n.a().CurrencyFormat)),k=n.a().CurrencySymbolLead,d=n.a().CurrencySeparatedBySpace,g=n.a().CurrencySymbolString,nt=n.a().DigitsCurrency,tt=n.a().DateOrder,it=tt===-1?"MDY":Enum.toString(_Ewa.tx,n.a().DateOrder).toUpperCase(),rt=n.a().DateSeparator.toString(),ut=n.a().DateAlternativeSeparator.toString(),ft=n.a().Year4Digits,et=n.a().Month2Digits,ot=n.a().Day2Digits,st=n.a().LongDateFormat,ht=n.a().TimeSeparator.toString(),ct=n.a().TimeAltSeparator==null?null:n.a().TimeAltSeparator.toString(),lt=n.a().Hour2Digits,at=n.a().Use24HourClock,vt=n.a().AmPmSeparatedBySpace,yt=[n.a().AmString,n.a().PmString],pt=n.a().DayNameShortArray,wt=n.a().DayNameLongArray,bt=n.a().MonthNameShortArray,kt=n.a().MonthNameLongArray,dt=n.a().PictureSpecialArray,gt=_Ewa.bt.c(("\x00"+n.a().PictureSingleString).split(""),function(n){return n==="\x00"?null:n}),ni=n.a().PictureColorArray,ti=n.a().PictureDbnumArray,ii=n.a().RowLetter.toString(),ri=n.a().ColumnLetter.toString(),ui=n.a().LeftBrace.toString(),fi=n.a().RightBrace.toString(),ei=n.a().LeftBracket.toString(),oi=n.a().RightBracket.toString();return excelOnlineCalc.calc.localeData(t,i,r,u,ii,ri,ui,fi,ei,oi,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti)};_Ewa.gG.c=function(n){var r=[],t,i;if(!n)return r;for(var f=n,e=f.length,u=0;u<e;++u)t=f[u],i=null,t.IsDynamicUdf||(i=excelOnlineCalc.calc.worksheetFunctionName(t.FunctionIndexInServer,t.NameUI)),i&&Array.add(r,i);return r};_Ewa.gG.b=function(){for(var t,i=[],r=Object.keys(_Ewa.fm.a),n=0;n<r.length;n++)t=excelOnlineCalc.calc.errorTypeName(n+1,r[n]),t&&Array.add(i,t);return i};_Ewa.gG.prototype={d:null,g:null,h:null,e:null,a:null,c:null,b:null,m:function(){var t,n,i;return _Ewa.bJ.a(this.d,"OfficeVSO:4986015_LetAutocompleteTelemetry")?(t=this.d.d(),!t)?(Diag.a.b(562394562,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0):(n=this.d.d().a(),!n)?(Diag.a.b(562394561,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0):n.W:(i=this.d.d().a(),i.W)},j:function(){var n={};return n.config=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.b:this.c,excelOnlineCalc.parse.createParser(n)},i:function(){var i=this,n=function(){return excelOnlineCalc.util.failure(excelOnlineCalc.util.notImplemented(["getTime"]))},t;return t=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?excelOnlineCalc.numfmt.createFormatGlobals(this.b,n):excelOnlineCalc.numfmt.createFormatGlobals(this.c,n),excelOnlineCalc.numfmt.createNumberFormatter(t)},k:function(n,t,i){var r=excelOnlineCalc.location.gridCell(t,i),u=excelOnlineCalc.location.sheetIndex(this.g,n);return excelOnlineCalc.location.sheetGridCell(u,r)},n:function(n,t,i,r){r.val=excelOnlineCalc.calc.getEvalResultKind(n);switch(r.val){case 4:return _Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?n?this.a.a.trueName:this.a.a.falseName:n?this.a.b.trueName:this.a.b.falseName;case 1:return _Ewa.a.b("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.f(this.a.g(n),t,i):this.a.g(n);case 2:return _Ewa.a.b("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.f(n.toString(),t,i):n.toString();case 128:return"";case 8:var u=n;switch(u.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return _Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.a.a.errorNames[u.type]:this.a.b.errorNames[u.type];default:return _Ewa.gG.a}case 32:return _Ewa.a.b("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.f(this.l(n,t,i),t,i):"##UNSUPPORTED: ARRAY";case 16:case 256:default:return _Ewa.ClientStringManager.a().a(1999)}},f:function(n,t,i){return!t||n.length<=i?n:n.substring(0,i-3)+"..."},l:function(n,t,i){for(var r,u=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData"),f=u?this.a.a.leftBrace:this.a.b.leftBrace,e=0;e<n.rows;++e){for(r=0;r<n.cols;++r)f+=n.opers[e][r],r<n.cols-1&&(f+=u?this.a.a.columnSeparator:this.a.b.columnSeparator);e<n.rows-1&&(f+=u?this.a.a.rowSeparator:this.a.b.rowSeparator)}return this.f(f,t,i-1)+(u?this.a.a.rightBrace:this.a.b.rightBrace)}};_Ewa.lU=function(n,t){var e,o;this.l=Function.createDelegate(this,this.q);this.i=Function.createDelegate(this,this.n);this.k=Function.createDelegate(this,this.p);this.j=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.g);this.m=Function.createDelegate(this,this.r);this.c=null;this.e=n;var i=".",r=",",u=",",f=";";t&&(this.c=t.c(),t.a()?(i=t.a().DecimalSeparator.toString(),r=t.a().ListSeparator.toString(),u=t.a().ColumnSeparator.toString(),f=t.a().RowSeparator.toString()):Diag.a.b(34445250,0,!1,"LocaleHolder constructor - locale information is not available"));this.d=["0","1","2","3","4","5","6","7","8","9"];!!this.c;o=(e=[""]).concat.apply(e,Object.keys(_Ewa.fm.a));this.b=excelOnlineCalc.config.localeInfo(this.m,this.h,this.j,this.k,_Ewa.lU.c,_Ewa.lU.a,this.i,this.l,_Ewa.lU.stringCompareCI,o,t&&t.a()&&t.a().TrueValueString?t.a().TrueValueString:"TRUE",t&&t.a()&&t.a().FalseValueString?t.a().FalseValueString:"FALSE","R","C","{","}","[","]",i,r,u,f);_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")&&(this.f=_Ewa.gG.d(t,_Ewa.gG.c(t.b())),this.a=excelOnlineCalc.calc.localeInfoFromData(this.f))};_Ewa.lU.b=function(n){switch(n){case"COUNT":return 0;case"IF":return 1;case"ISNA":return 2;case"ISERROR":return 3;case"SUM":return 4;case"AVERAGE":return 5;case"MIN":return 6;case"MAX":return 7;case"ROW":return 8;case"COLUMN":return 9;case"NA":return 10;case"NPV":return 11;case"STDEV":return 12;case"DOLLAR":return 13;case"FIXED":return 14;case"SIN":return 15;case"COS":return 16;case"TAN":return 17;case"ATAN":return 18;case"PI":return 19;case"SQRT":return 20;case"EXP":return 21;case"LN":return 22;case"LOG10":return 23;case"ABS":return 24;case"INT":return 25;case"SIGN":return 26;case"ROUND":return 27;case"LOOKUP":return 28;case"INDEX":return 29;case"REPT":return 30;case"MID":return 31;case"LEN":return 32;case"VALUE":return 33;case"TRUE":return 34;case"FALSE":return 35;case"AND":return 36;case"OR":return 37;case"NOT":return 38;case"MOD":return 39;case"DCOUNT":return 40;case"DSUM":return 41;case"DAVERAGE":return 42;case"DMIN":return 43;case"DMAX":return 44;case"DSTDEV":return 45;case"VAR":return 46;case"DVAR":return 47;case"TEXT":return 48;case"LINEST":return 49;case"TREND":return 50;case"LOGEST":return 51;case"GROWTH":return 52;case"GOTO":return 53;case"HALT":return 54;case"RETURN":return 55;case"PV":return 56;case"FV":return 57;case"NPER":return 58;case"PMT":return 59;case"RATE":return 60;case"MIRR":return 61;case"IRR":return 62;case"RAND":return 63;case"MATCH":return 64;case"DATE":return 65;case"TIME":return 66;case"DAY":return 67;case"MONTH":return 68;case"YEAR":return 69;case"WEEKDAY":return 70;case"HOUR":return 71;case"MINUTE":return 72;case"SECOND":return 73;case"NOW":return 74;case"AREAS":return 75;case"ROWS":return 76;case"COLUMNS":return 77;case"OFFSET":return 78;case"ABSREF":return 79;case"RELREF":return 80;case"ARGUMENT":return 81;case"SEARCH":return 82;case"TRANSPOSE":return 83;case"ERROR":return 84;case"STEP":return 85;case"TYPE":return 86;case"ECHO":return 87;case"SET.NAME":return 88;case"CALLER":return 89;case"DEREF":return 90;case"WINDOWS":return 91;case"SERIES":return 92;case"DOCUMENTS":return 93;case"ACTIVE.CELL":return 94;case"SELECTION":return 95;case"RESULT":return 96;case"ATAN2":return 97;case"ASIN":return 98;case"ACOS":return 99;case"CHOOSE":return 100;case"HLOOKUP":return 101;case"VLOOKUP":return 102;case"LINKS":return 103;case"INPUT":return 104;case"ISREF":return 105;case"GET.FORMULA":return 106;case"GET.NAME":return 107;case"SET.VALUE":return 108;case"LOG":return 109;case"EXEC":return 110;case"CHAR":return 111;case"LOWER":return 112;case"UPPER":return 113;case"PROPER":return 114;case"LEFT":return 115;case"RIGHT":return 116;case"EXACT":return 117;case"TRIM":return 118;case"REPLACE":return 119;case"SUBSTITUTE":return 120;case"CODE":return 121;case"NAMES":return 122;case"DIRECTORY":return 123;case"FIND":return 124;case"CELL":return 125;case"ISERR":return 126;case"ISTEXT":return 127;case"ISNUMBER":return 128;case"ISBLANK":return 129;case"T":return 130;case"N":return 131;case"FOPEN":return 132;case"FCLOSE":return 133;case"FSIZE":return 134;case"FREADLN":return 135;case"FREAD":return 136;case"FWRITELN":return 137;case"FWRITE":return 138;case"FPOS":return 139;case"DATEVALUE":return 140;case"TIMEVALUE":return 141;case"SLN":return 142;case"SYD":return 143;case"DDB":return 144;case"GET.DEF":return 145;case"REFTEXT":return 146;case"TEXTREF":return 147;case"INDIRECT":return 148;case"REGISTER":return 149;case"CALL":return 150;case"ADD.BAR":return 151;case"ADD.MENU":return 152;case"ADD.COMMAND":return 153;case"ENABLE.COMMAND":return 154;case"CHECK.COMMAND":return 155;case"RENAME.COMMAND":return 156;case"SHOW.BAR":return 157;case"DELETE.MENU":return 158;case"DELETE.COMMAND":return 159;case"GET.CHART.ITEM":return 160;case"DIALOG.BOX":return 161;case"CLEAN":return 162;case"MDETERM":return 163;case"MINVERSE":return 164;case"MMULT":return 165;case"FILES":return 166;case"IPMT":return 167;case"PPMT":return 168;case"COUNTA":return 169;case"CANCEL.KEY":return 170;case"FOR":return 171;case"WHILE":return 172;case"BREAK":return 173;case"NEXT":return 174;case"INITIATE":return 175;case"REQUEST":return 176;case"POKE":return 177;case"EXECUTE":return 178;case"TERMINATE":return 179;case"RESTART":return 180;case"HELP":return 181;case"GET.BAR":return 182;case"PRODUCT":return 183;case"FACT":return 184;case"GET.CELL":return 185;case"GET.WORKSPACE":return 186;case"GET.WINDOW":return 187;case"GET.DOCUMENT":return 188;case"DPRODUCT":return 189;case"ISNONTEXT":return 190;case"GET.NOTE":return 191;case"NOTE":return 192;case"STDEVP":return 193;case"VARP":return 194;case"DSTDEVP":return 195;case"DVARP":return 196;case"TRUNC":return 197;case"ISLOGICAL":return 198;case"DCOUNTA":return 199;case"DELETE.BAR":return 200;case"UNREGISTER":return 201;case"USDOLLAR":return 204;case"FINDB":return 205;case"SEARCHB":return 206;case"REPLACEB":return 207;case"LEFTB":return 208;case"RIGHTB":return 209;case"MIDB":return 210;case"LENB":return 211;case"ROUNDUP":return 212;case"ROUNDDOWN":return 213;case"ASC":return 214;case"DBCS":return 215;case"RANK":return 216;case"ADDRESS":return 219;case"DAYS360":return 220;case"TODAY":return 221;case"VDB":return 222;case"ELSE":return 223;case"ELSE.IF":return 224;case"END.IF":return 225;case"FOR.CELL":return 226;case"MEDIAN":return 227;case"SUMPRODUCT":return 228;case"SINH":return 229;case"COSH":return 230;case"TANH":return 231;case"ASINH":return 232;case"ACOSH":return 233;case"ATANH":return 234;case"DGET":return 235;case"CREATE.OBJECT":return 236;case"VOLATILE":return 237;case"LAST.ERROR":return 238;case"CUSTOM.UNDO":return 239;case"CUSTOM.REPEAT":return 240;case"FORMULA.CONVERT":return 241;case"GET.LINK.INFO":return 242;case"TEXT.BOX":return 243;case"INFO":return 244;case"GROUP":return 245;case"GET.OBJECT":return 246;case"DB":return 247;case"PAUSE":return 248;case"RESUME":return 251;case"FREQUENCY":return 252;case"ADD.TOOLBAR":return 253;case"DELETE.TOOLBAR":return 254;case"RESET.TOOLBAR":return 256;case"EVALUATE":return 257;case"GET.TOOLBAR":return 258;case"GET.TOOL":return 259;case"SPELLING.CHECK":return 260;case"ERROR.TYPE":return 261;case"APP.TITLE":return 262;case"WINDOW.TITLE":return 263;case"SAVE.TOOLBAR":return 264;case"ENABLE.TOOL":return 265;case"PRESS.TOOL":return 266;case"REGISTER.ID":return 267;case"GET.PROJECT":return 268;case"AVEDEV":return 269;case"BETADIST":return 270;case"GAMMALN":return 271;case"BETAINV":return 272;case"BINOMDIST":return 273;case"CHIDIST":return 274;case"CHIINV":return 275;case"COMBIN":return 276;case"CONFIDENCE":return 277;case"CRITBINOM":return 278;case"EVEN":return 279;case"EXPONDIST":return 280;case"FDIST":return 281;case"FINV":return 282;case"FISHER":return 283;case"FISHERINV":return 284;case"FLOOR":return 285;case"GAMMADIST":return 286;case"GAMMAINV":return 287;case"CEILING":return 288;case"HYPGEOMDIST":return 289;case"LOGNORMDIST":return 290;case"LOGINV":return 291;case"NEGBINOMDIST":return 292;case"NORMDIST":return 293;case"NORMSDIST":return 294;case"NORMINV":return 295;case"NORMSINV":return 296;case"STANDARDIZE":return 297;case"ODD":return 298;case"PERMUT":return 299;case"POISSON":return 300;case"TDIST":return 301;case"WEIBULL":return 302;case"SUMXMY2":return 303;case"SUMX2MY2":return 304;case"SUMX2PY2":return 305;case"CHITEST":return 306;case"CORREL":return 307;case"COVAR":return 308;case"FORECAST":return 309;case"FTEST":return 310;case"INTERCEPT":return 311;case"PEARSON":return 312;case"RSQ":return 313;case"STEYX":return 314;case"SLOPE":return 315;case"TTEST":return 316;case"PROB":return 317;case"DEVSQ":return 318;case"GEOMEAN":return 319;case"HARMEAN":return 320;case"SUMSQ":return 321;case"KURT":return 322;case"SKEW":return 323;case"ZTEST":return 324;case"LARGE":return 325;case"SMALL":return 326;case"QUARTILE":return 327;case"PERCENTILE":return 328;case"PERCENTRANK":return 329;case"MODE":return 330;case"TRIMMEAN":return 331;case"TINV":return 332;case"MOVIE.COMMAND":return 334;case"GET.MOVIE":return 335;case"CONCATENATE":return 336;case"POWER":return 337;case"SPREADBASE.DATA.FIELD":return 338;case"GET.VIEW":return 339;case"GET.FIELD":return 340;case"GET.ITEM":return 341;case"RADIANS":return 342;case"DEGREES":return 343;case"SUBTOTAL":return 344;case"SUMIF":return 345;case"COUNTIF":return 346;case"COUNTBLANK":return 347;case"SCENARIO.GET":return 348;case"OPTIONS.LISTS":return 349;case"ISPMT":return 350;case"DATEDIF":return 351;case"DATESTRING":return 352;case"NUMBERSTRING":return 353;case"ROMAN":return 354;case"OPENDIALOG":return 355;case"SAVEDIALOG":return 356;case"VIEW.GET":return 357;case"GETPIVOTDATA":return 358;case"HYPERLINK":return 359;case"FURIGANA":return 360;case"AVERAGEA":return 361;case"MAXA":return 362;case"MINA":return 363;case"STDEVPA":return 364;case"VARPA":return 365;case"STDEVA":return 366;case"VARA":return 367;case"BAHTTEXT":return 368;case"THAIDOW":return 369;case"THAIDIGIT":return 370;case"THAIMOY":return 371;case"THAINUMSOUND":return 372;case"THAINUMSTRING":return 373;case"THAISTRINGLENGTH":return 374;case"ISTHAIDIGIT":return 375;case"ROUNDBAHTDOWN":return 376;case"ROUNDBAHTUP":return 377;case"THAIYEAR":return 378;case"RTD":return 379;case"CUBEVALUE":return 380;case"CUBEMEMBER":return 381;case"CUBEMEMBERPROPERTY":return 382;case"CUBERANKEDMEMBER":return 383;case"HEX2BIN":return 384;case"HEX2DEC":return 385;case"HEX2OCT":return 386;case"DEC2BIN":return 387;case"DEC2HEX":return 388;case"DEC2OCT":return 389;case"OCT2BIN":return 390;case"OCT2HEX":return 391;case"OCT2DEC":return 392;case"BIN2DEC":return 393;case"BIN2OCT":return 394;case"BIN2HEX":return 395;case"IMSUB":return 396;case"IMDIV":return 397;case"IMPOWER":return 398;case"IMABS":return 399;case"IMSQRT":return 400;case"IMLN":return 401;case"IMLOG2":return 402;case"IMLOG10":return 403;case"IMSIN":return 404;case"IMCOS":return 405;case"IMEXP":return 406;case"IMARGUMENT":return 407;case"IMCONJUGATE":return 408;case"IMAGINARY":return 409;case"IMREAL":return 410;case"COMPLEX":return 411;case"IMSUM":return 412;case"IMPRODUCT":return 413;case"SERIESSUM":return 414;case"FACTDOUBLE":return 415;case"SQRTPI":return 416;case"QUOTIENT":return 417;case"DELTA":return 418;case"GESTEP":return 419;case"ISEVEN":return 420;case"ISODD":return 421;case"MROUND":return 422;case"ERF":return 423;case"ERFC":return 424;case"BESSELJ":return 425;case"BESSELK":return 426;case"BESSELY":return 427;case"BESSELI":return 428;case"XIRR":return 429;case"XNPV":return 430;case"PRICEMAT":return 431;case"YIELDMAT":return 432;case"INTRATE":return 433;case"RECEIVED":return 434;case"DISC":return 435;case"PRICEDISC":return 436;case"YIELDDISC":return 437;case"TBILLEQ":return 438;case"TBILLPRICE":return 439;case"TBILLYIELD":return 440;case"PRICE":return 441;case"YIELD":return 442;case"DOLLARDE":return 443;case"DOLLARFR":return 444;case"NOMINAL":return 445;case"EFFECT":return 446;case"CUMPRINC":return 447;case"CUMIPMT":return 448;case"EDATE":return 449;case"EOMONTH":return 450;case"YEARFRAC":return 451;case"COUPDAYBS":return 452;case"COUPDAYS":return 453;case"COUPDAYSNC":return 454;case"COUPNCD":return 455;case"COUPNUM":return 456;case"COUPPCD":return 457;case"DURATION":return 458;case"MDURATION":return 459;case"ODDLPRICE":return 460;case"ODDLYIELD":return 461;case"ODDFPRICE":return 462;case"ODDFYIELD":return 463;case"RANDBETWEEN":return 464;case"WEEKNUM":return 465;case"AMORDEGRC":return 466;case"AMORLINC":return 467;case"CONVERT":return 468;case"ACCRINT":return 469;case"ACCRINTM":return 470;case"WORKDAY":return 471;case"NETWORKDAYS":return 472;case"GCD":return 473;case"MULTINOMIAL":return 474;case"LCM":return 475;case"FVSCHEDULE":return 476;case"CUBEKPIMEMBER":return 477;case"CUBESET":return 478;case"CUBESETCOUNT":return 479;case"IFERROR":return 480;case"COUNTIFS":return 481;case"SUMIFS":return 482;case"AVERAGEIF":return 483;case"AVERAGEIFS":return 484;case"AGGREGATE":return 485;case"BINOM.DIST":return 486;case"BINOM.INV":return 487;case"CONFIDENCE.NORM":return 488;case"CONFIDENCE.T":return 489;case"CHISQ.TEST":return 490;case"F.TEST":return 491;case"COVARIANCE.P":return 492;case"COVARIANCE.S":return 493;case"EXPON.DIST":return 494;case"GAMMA.DIST":return 495;case"GAMMA.INV":return 496;case"MODE.MULT":return 497;case"MODE.SNGL":return 498;case"NORM.DIST":return 499;case"NORM.INV":return 500;case"PERCENTILE.EXC":return 501;case"PERCENTILE.INC":return 502;case"PERCENTRANK.EXC":return 503;case"PERCENTRANK.INC":return 504;case"POISSON.DIST":return 505;case"QUARTILE.EXC":return 506;case"QUARTILE.INC":return 507;case"RANK.AVG":return 508;case"RANK.EQ":return 509;case"STDEV.S":return 510;case"STDEV.P":return 511;case"T.DIST":return 512;case"T.DIST.2T":return 513;case"T.DIST.RT":return 514;case"T.INV":return 515;case"T.INV.2T":return 516;case"VAR.S":return 517;case"VAR.P":return 518;case"WEIBULL.DIST":return 519;case"NETWORKDAYS.INTL":return 520;case"WORKDAY.INTL":return 521;case"ECMA.CEILING":return 522;case"ISO.CEILING":return 523;case"BETA.DIST":return 525;case"BETA.INV":return 526;case"CHISQ.DIST":return 527;case"CHISQ.DIST.RT":return 528;case"CHISQ.INV":return 529;case"CHISQ.INV.RT":return 530;case"F.DIST":return 531;case"F.DIST.RT":return 532;case"F.INV":return 533;case"F.INV.RT":return 534;case"HYPGEOM.DIST":return 535;case"LOGNORM.DIST":return 536;case"LOGNORM.INV":return 537;case"NEGBINOM.DIST":return 538;case"NORM.S.DIST":return 539;case"NORM.S.INV":return 540;case"T.TEST":return 541;case"Z.TEST":return 542;case"ERF.PRECISE":return 543;case"ERFC.PRECISE":return 544;case"GAMMALN.PRECISE":return 545;case"CEILING.PRECISE":return 546;case"FLOOR.PRECISE":return 547;case"ACOT":return 548;case"ACOTH":return 549;case"COT":return 550;case"COTH":return 551;case"CSC":return 552;case"CSCH":return 553;case"SEC":return 554;case"SECH":return 555;case"IMTAN":return 556;case"IMCOT":return 557;case"IMCSC":return 558;case"IMCSCH":return 559;case"IMSEC":return 560;case"IMSECH":return 561;case"BITAND":return 562;case"BITOR":return 563;case"BITXOR":return 564;case"BITLSHIFT":return 565;case"BITRSHIFT":return 566;case"PERMUTATIONA":return 567;case"COMBINA":return 568;case"XOR":return 569;case"PDURATION":return 570;case"BASE":return 571;case"DECIMAL":return 572;case"DAYS":return 573;case"BINOM.DIST.RANGE":return 574;case"GAMMA":return 575;case"SKEW.P":return 576;case"GAUSS":return 577;case"PHI":return 578;case"RRI":return 579;case"UNICHAR":return 580;case"UNICODE":return 581;case"MUNIT":return 582;case"ARABIC":return 583;case"ISOWEEKNUM":return 584;case"NUMBERVALUE":return 585;case"SHEET":return 586;case"SHEETS":return 587;case"FORMULATEXT":return 588;case"ISFORMULA":return 589;case"IFNA":return 590;case"CEILING.MATH":return 591;case"FLOOR.MATH":return 592;case"IMSINH":return 593;case"IMCOSH":return 594;case"FILTERXML":return 595;case"WEBSERVICE":return 596;case"ENCODEURL":return 597;case"FORECAST.ETS":return 598;case"FORECAST.ETS.CONFINT":return 599;case"FORECAST.ETS.SEASONALITY":return 600;case"FORECAST.LINEAR":return 601;case"FORECAST.ETS.STAT":return 602;case"MAXIFS":return 603;case"MINIFS":return 604;case"TEXTJOIN":return 605;case"CONCAT":return 606;case"IFS":return 607;case"SWITCH":return 608}return null};_Ewa.lU.c=function(n){return isNullOrUndefined(n)?!1:n>="0"&&n<="9"};_Ewa.lU.a=function(n){return parseInt(n.toString())};_Ewa.lU.stringCompareCI=function(n,t){return _Ewa.f.f(n,t,!0)};_Ewa.lU.prototype={d:null,e:null,c:null,b:null,a:null,f:null,r:function(n){return this.c?this.c.toNumber(n):Number.parse(n,Sys.CultureInfo.CurrentCulture)},g:function(n){return _Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.a.formatNumber(n):n.toString().replace(".",this.b.decimalSeparator)},o:function(n){var i,r,t;return!n||!n.length?null:(i=this.e.a().a(_Ewa.cV,268,!1,null),!i)?(Diag.a.b(34445251,0,!1,"CalcHelper.GetWorksheetFuncId() - failed to get the instantaneousSupportInformationManager"),null):(r=i.t(n.toLocaleUpperCase()),r)?Number.parse(r.toString(),Sys.CultureInfo.InvariantCulture):(t=_Ewa.lU.b(n),!t)?(Diag.a.a(34445252,0,50,"CalcHelper.GetWorksheetFuncId() - function index by name was not found. This can happen for user defined functions"),null):(Diag.a.a(36706337,0,50,"CalcHelper.GetWorksheetFuncId() - function name was not found by dynamic list but found by static list. id={0}.",t.toString()),t)},p:function(n){var i=this.e.a().a(_Ewa.cV,268,!1,null),t;return i?(t=i.u(n),!t||!t.length)?(Diag.a.a(34445254,0,15,"CalcHelper.GetWorksheetFuncId() - function name was not found by id {0}",n),null):t:(Diag.a.b(34445253,0,!1,"CalcHelper.GetWorksheetFuncName() - failed to get the instantaneousSupportInformationManager"),null)},n:function(n){return n<0||n>this.d.length-1?new String:this.d[n]},q:function(n){return isNullOrUndefined(n)?!1:_Ewa.a.b("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?_Ewa.f.s(n.toString().charCodeAt(0)):_Ewa.f.t(n.toString().charCodeAt(0))}};_Ewa.CalcManager=function(n){this.K=Function.createDelegate(this,this.R);this.D=Function.createDelegate(this,this.M);this.E=Function.createDelegate(this,this.N);this.I=Function.createDelegate(this,this.Y);this.J=Function.createDelegate(this,this.Z);Diag.a.a(34936847,0,50,"Creating CalcManager");this.F=!1;this.y=n;this.w=_Ewa.c.a(n);this.v=null;this.A=[];this.w.A(this.J);this.w.b().z(this.I);var t=this;this.y.a().c(_Ewa.cV,268,function(n){n.a()?(Diag.a.a(576071815,0,50,"CalcManager.ctor: LocaleInformation already available..."),t.N(n,Sys.EventArgs.Empty)):(Diag.a.a(576071814,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),n.k(t.E))},null)};_Ewa.CalcManager.c=function(n,t){return t.length>n.span.end&&t.charAt(n.span.end)==="#"};_Ewa.CalcManager.b=function(n){return _Ewa.q.a(n.range.row+1,n.range.col+1,!1)};_Ewa.CalcManager.prototype={x:null,C:!1,B:null,z:null,A:null,F:!1,k:function(){return this.F},v:null,w:null,y:null,G:null,a:function(){return this.G},l:function(){return this.v.b.localeInfo},dispose:function(){Diag.a.a(34445255,0,50,"CalcManager.Dispose called");var n=this;this.y.a().c(_Ewa.cV,268,function(t){t.g(n.E);t.f(n.D)},null);this.w&&(this.w.D(this.J),this.w.b()&&this.w.b().O(this.I),this.w=null);this.v=null;this.A=null},g:function(n,t,i,r,u){this.x&&this.x.U(n,t,i,r,u)},h:function(n){return this.x?this.x.bc(n):Promise.reject("calc engine not initialized")},t:function(n){return this.x?(Diag.a.b(574682055,0,n.l()===2,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.x.bf(n)):null},e:function(n,t){if(!t||n.l()!==2)return!1;var i=_Ewa.bE.a(n,!1);return i.c-i.b+1===t.f.length},j:function(n){var r,t,u,i;if(!this.B)return this.C||Diag.a.a(37826832,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;if(r=this.c(_Ewa.q.a(1,1,!1)),t=this.B.parseFormula(2,r,1,n),!excelOnlineCalc.parse.parseResultHelper.isSuccess(t))return Diag.a.a(37826833,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{return u=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.v.b.localeInfo:this.v.c.localeInfo,i=excelOnlineCalc.parse.parseResultHelper.extractReferences(t,u,_Ewa.a.a(819)),_Ewa.a.a(108)&&this.bb(i,n),i}catch(f){return Diag.a.a(39396449,0,10,"CalcManager.ExtractReferenceWrappers - exception: {0}",f.message),null}},i:function(n,t){var r,i,u,f;if(!this.B)return this.C||Diag.a.a(588891980,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;if(r=this.c(_Ewa.q.a(1,1,!1)),i=this.B.parseFormula(2,r,1,n),!excelOnlineCalc.parse.parseResultHelper.isSuccess(i))return Diag.a.a(588891979,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return u=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.v.b.localeInfo:this.v.c.localeInfo,f=excelOnlineCalc.parse.parseResultHelper.extractLetVariables(i,t,u),f}catch(e){return Diag.a.a(588891978,0,10,"CalcManager.ExtractLetVariables - exception: {0}",e.message),null}},d:function(n,t,i){var r;if(!t)return Diag.a.a(38576192,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!i)return Diag.a.a(38576193,0,10,"CalcManager.ExtractReferences - documentName is null"),null;if(r=this.j(n),!r)return Diag.a.a(39396450,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.P(r,t,i,n)}catch(u){return Diag.a.a(37826834,0,10,"CalcManager.ExtractReferences - exception: {0}",u.message),null}},p:function(n,t,i,r){var u,f,s,h,e,o,c;return n?!t||t.length<=0?(Diag.a.a(42473291,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null):(u=this.c(n),!this.v||!u)?null:(f=!1,e=(h=this.L(u,s={val:f}),f=s.val,h),!e||e.N())?null:(o=excelOnline.utils.getCharIndexInTextFromPoint(i,r,_Ewa.a.a(819)),o<0)?null:(c=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.v.b:this.v.c,excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(c,o,t,u)):(Diag.a.a(42473290,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null)},f:function(n,t,i,r){if(!n)return Diag.a.a(41756244,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),null;var u=null,f=this,e=function(n){var o,s,h,t=(h=f.v.n(n,!0,i,s={val:o}),o=s.val,h),e,c;return o!==8||t.length&&t!==_Ewa.gG.a?e=0:(Diag.a.a(41756250,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),c=excelOnlineCalc.calc.getEvalFailureReason(n),isNullOrUndefined(c)&&Diag.a.b(587559249,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),e=1),u=r?new _Ewa.lV(t,r.start,r.end,e):new _Ewa.lV(t,-1,-1,e)},o=this;return this.h(t).then(e,function(n){return Diag.a.a(41756251,0,10,"EvalSession.GetPartialResultValueForFormula - exception: {0}",n),Promise.resolve(u)})},q:function(n){return!this.v||!n?null:excelOnlineCalc.runtime.getSubExpressionSpan(n)},m:function(n,t,i){if(!this.v||!n||!t||!i)return null;var r=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.v.b:this.v.c;return excelOnlineCalc.runtime.getFormulaSubExpressionObject(r,t,i,this.c(n))},s:function(n,t,i){if(!this.v||!n||!t)return null;var r=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.v.b:this.v.c;return excelOnlineCalc.runtime.getSubstitutedSubExpressionString(r,t,i,this.c(n))},r:function(n,t,i){if(!this.v||!n||!t)return null;var r=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.v.b.localeInfo:this.v.c.localeInfo;return excelOnlineCalc.runtime.getSubExpressionSubspans(r,t,i)},n:function(){if(!this.v)return null;var n=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.v.b.localeInfo:this.v.c.localeInfo;return n.listSeparator},u:function(n){if(!this.v)return!1;var t=_Ewa.a.b("OfficeVSO:4978907_UseExtendedLocaleData")?this.v.b.localeInfo:this.v.c.localeInfo;return excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(t,n)},c:function(n){if(!n||!this.v)return null;return this.v.k(this.v.m(),n.a-1,n.b-1)},R:function(n){var t=null,i,r,u,f=(u=this.L(n,r={val:i}),i=r.val,u);return f&&(t=this.U(f.b())),t},o:function(n){var t,i;return this.A[n]?this.A[n]:(t=this.z.d()[n],!t)?null:(i=this.G.createFormat(t.FormatString,t.Builtin),excelOnlineCalc.util.isSuccess(i))?this.A[n]=i.value:null},U:function(n){return n===-1?0:n},P:function(n,t,i,r){var b=_Ewa.a.a(1039),h={},a,u,s,k,v,f,l,p,w,e,o,g;for(h.Items=new Array(0),a=0;a<n.length;a++)if(u=n[a],s={},s.Start=u.span.start,s.End=u.span.end,b&&u.kind==="function")k=u.ref,s.End=u.span.start+k.name.length,v={},v.Span=s,v.IsFunction=!0,Array.add(h.Items,v);else if(b&&u.kind==="literal"){var d=u.ref,y=d.value.oper.kind,c={};c.Span=s;c.IsString=y===2;c.IsBoolean=y===4;c.IsNumber=y===1;Array.add(h.Items,c)}else{if(!this.Q(u,t,i))continue;f=new _Ewa.CalcManager.a;l=this.V(u,t,f,r);_Ewa.a.a(819)?(p=this.T(u),w=this.S(u),(l||w&&p>=0)&&(e={},e.Span=s,e.LetNumber=p,e.LetName=w,e.Range=l,e.IsRangeRef=f.e,e.IsAbsoluteFirstRow=f.b,e.IsAbsoluteFirstColumn=f.a,e.IsAbsoluteSecondRow=f.d,e.IsAbsoluteSecondColumn=f.c,Array.add(h.Items,e))):l&&(o={},o.Span=s,o.Range=l,o.IsRangeRef=f.e,o.IsAbsoluteFirstRow=f.b,o.IsAbsoluteFirstColumn=f.a,o.IsAbsoluteSecondRow=f.d,o.IsAbsoluteSecondColumn=f.c,Array.add(h.Items,o))}return g=this,h.Items.sort(function(n,t){return n.Span.Start-t.Span.Start}),h},T:function(n){if(n.kind==="letName"){var t=n.ref;return t.number}return-1},S:function(n){if(n.kind==="letName"){var t=n.ref;return t.name}return null},V:function(n,t,i,r){var f,u,e;return n.kind==="range"?(i.e=!0,this.O(n,t,i,r)):n.kind==="namedRange"?(f=n.ref,u=this.y.n().b(f.name),u||(u=this.y.n().b(t+"!"+f.name)),!u||!u.b()||!u.f())?null:_Ewa.f.b(u.b(),t,!0)?(e=u.l()===2?_Ewa.bE.a(u,!1):u.f(),_Ewa.h.r(e,u)):null:null},O:function(n,t,i,r){var u=n.ref,k,c;if(u.type){if(u.type==="col"){var p=u,w=p.startIndex,b=p.endIndex;return i.a=w.kind==="Abs",i.c=b.kind==="Abs",this.H(0,w.index,1048576,b.index,t)}if(u.type==="row"){var f=u,d=f.startIndex,g=f.endIndex;return i.b=d.kind==="Abs",i.d=g.kind==="Abs",this.H(f.startIndex.index,0,f.endIndex.index,16384,t)}if(u.type==="cell"){var h=u,e=h.row,o=h.col;return(i.b=i.d=e.kind==="Abs",i.a=i.c=o.kind==="Abs",this.b(h.span.end,r)&&(k=_Ewa.q.a(e.index+1,o.index+1,!1),c=this.w.e().t(k),c))?_Ewa.h.N(c,t):this.H(e.index,o.index,e.index,o.index,t)}if(u.type==="range"){var s=u,l=s.top,a=s.left,v=s.bottom,y=s.right,nt=Math.min(l.index,v.index),tt=Math.min(a.index,y.index),it=Math.max(l.index,v.index),rt=Math.max(a.index,y.index);return i.b=l.kind==="Abs",i.d=v.kind==="Abs",i.a=a.kind==="Abs",i.c=y.kind==="Abs",this.H(nt,tt,it,rt,t)}return Diag.a.a(37826835,0,10,"CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '{0}'",u.type),null}return Diag.a.a(38082381,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null"),null},b:function(n,t){return t.length>=n&&n>0&&t.charAt(n-1)==="#"},bb:function(n,t){var i,u;if(n)for(var f=n,e=f.length,r=0;r<e;++r)(i=f[r],i.ref.type&&i.ref.type==="cell")&&(u=i.ref,_Ewa.CalcManager.c(u,t)&&(u.span.end+=1,i.span.end+=1))},H:function(n,t,i,r,u){var f={};return f.FirstRow=n,f.FirstColumn=t,f.LastRow=i,f.LastColumn=r,f.SheetName=u,f},Q:function(n,t,i){var r=n.ref.qualifier,f,e,l,a,h;if(!r)return!0;switch(n.ref.qualifier.type){case"Sheet":return f=r,e=f.document,_Ewa.f.b(f.sheet,t,!0)&&(!e||_Ewa.f.b(e.document,i,!0));case"SheetRange":var c=r,u=this.y.d().b(t),o=this.y.d().b(c.sheet1),s=this.y.d().b(c.sheet2);return!!u&&!!o&&!!s&&(o.c()<=u.c()&&u.c()<=s.c()||s.c()<=u.c()&&u.c()<=o.c());case"Document":return l=r,_Ewa.f.b(l.document,i,!0);case"Ident":return a=r,h=a.name,_Ewa.f.b(h,t,!0)||_Ewa.f.b(h,i,!0);default:return Diag.a.a(38113474,0,10,"CalcManager.GetQualifierData: Unsupported formula qualifier type '{0}'",r.type),!1}},X:function(){var n=!0;try{n=excelOnlineCalc!==undefined}catch(t){return!1}try{n=excelOnlineCalc.location!==undefined}catch(i){return!1}return!0},ba:function(n){return(this.z=n,!n.d().length||!n.b().length)?(Diag.a.a(34936850,0,15,"CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = {0}, functions info count = {1}",n.d().length,n.b().length.toString()),!1):this.X()?(this.v=new _Ewa.gG(this.w.c(),this.K),this.B=this.v.j(),_Ewa.p.C(this.y)&&(this.G=this.v.i()),this.F=!0,Diag.a.a(34936851,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.x||(Diag.a.a(40768414,0,50,"CalcManager creating calc engine"),this.x=new _Ewa.dt(this.y)),!0):(Diag.a.b(40939861,0,this.C,"CalcManager.TryInitializeInternal: ExcelOnlineCalc is not loaded, any usage of it causes JS crash. Aborting calc initialization."),this.C=!0,!1)},N:function(n){Diag.a.a(34936852,0,50,"CalcManager.OnLocaleInformationAvailable() called");var t=n;if(t.g(this.E),!t.b().length){Diag.a.a(34936853,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information");t.j(this.D);return}this.M(n,Sys.EventArgs.Empty)},M:function(n){Diag.a.a(34936854,0,50,"CalcManager.OnFunctionsInfoReady called");var t=n;t.f(this.D);this.ba(t)},Z:function(){if(this.x&&(!this.z||!this.z.e())){var n=this;$$sc.a.b(0).CWCT(function(){n.x.D(1)},null,0,$$sc.c.a)}},Y:function(n,t){this.x&&(this.z&&this.z.e()||this.x.K(t.a.a))},L:function(n,t){var r,u,i;return(t.val=!1,!n)?null:(r=this.W(n.sheet.index),!r)?(Diag.a.a(37789893,0,50,"CalcManager.GetCellFromBlockCache: No sheet index {0}",n.sheet.index),null):(u=_Ewa.CalcManager.b(n),i=this.w.bW(r,u.a,u.b),!i)?(Diag.a.a(37789894,0,50,"CalcManager.GetCellFromBlockCache: cellProxy is null for cell {0} {1}",n.range.row,n.range.col),null):i.bL()?i:(Diag.a.a(37789895,0,50,"CalcManager.GetCellFromBlockCache: cell {0} {1} is empty",n.range.row,n.range.col),t.val=!0,null)},W:function(n){var t=this.w.c().d().g(n);return t?t.b():(Diag.a.a(37789896,0,50,"CalcManager.GetSheetName - no sheet in index {0}",n),null)}};_Ewa.CalcManager.a=function(){};_Ewa.CalcManager.a.prototype={e:!1,b:!1,a:!1,d:!1,c:!1};_Ewa.uE=function(n){_Ewa.uE.initializeBase(this);this.i=n;this.l()};_Ewa.uE.a=function(n){n&&n.a()&&n.a().b(_Ewa.bjT.$$(_Ewa.dQ),265,new _Ewa.uE(n))};_Ewa.uE.prototype={i:null,b:function(){var t,i,n;if(!this.i){Diag.a.a(38082339,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service");return}Diag.a.a(38082369,0,50,"CalcManagerFactory.Create: Start loading script");_Ewa.a.a(642)?(t=54,i="Test"):(t=57,i="Stable");Diag.a.a(592221332,0,50,"CalcManagerFactory.Create: Calc {0} JS was loaded",i);n=this;_Ewa.g.a(_Ewa.t.c(t,4,this.j,!1,!1,265),function(){Diag.a.a(38082370,0,50,"CalcManagerFactory.Create: Raised create service event");var t=n.i.a().a(_Ewa.dQ,266,!1,null);t||(Diag.a.a(39982036,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),t=new _Ewa.CalcManager(n.i));n.k(t)},this.h(),3,null,null)}};_Ewa.ColoredReferencesManager=function(n,t){this.m=Function.createDelegate(this,this.w);this.g=["rgba(95, 140, 237, {0})","rgba(235, 94, 96, {0})","rgba(141, 97, 194, {0})","rgba(45, 150, 57, {0})","rgba(191, 76, 145, {0})","rgba(227, 130, 34, {0})","rgba(55, 127, 158, {0})"];this.h=n;this.f=_Ewa.c.a(n);this.k=t;this.p=_Ewa.a.b("OfficeVSO:5090256_RestoreOutOfBoundsCaretPositionFix");this.o=_Ewa.a.b("OfficeVSO:5041666_ImplementLogRecorderOnEwaJS");this.f.g().h(this.m)};_Ewa.ColoredReferencesManager.prototype={f:null,h:null,k:null,p:!1,o:!1,q:!1,j:!1,b:function(n,t){var r,i,tt,s,a,v,y,it,p,w,rt;if(this.o&&n.a().c("ColoredReferencesManager.TryUpdateColoredReferences",null),this.q)return!_Ewa.a.b("OfficeVSO:5141958_FixTryUpdateColoredReferencesResultWithSuspendColoredReferences");if(r=isNullOrUndefined(t)?n.b():t,this.k&&r.length>1&&_Ewa.bB.b(r)){if(!_Ewa.f.a(n.a().j()))return!1;var b=this.s(),ut=this.v(),ft=this.u(),k=this.k.d(r,ut,ft);if(!k)return Diag.a.a(37859356,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),!1;for(var o=new Array(0),u=new Array(0),d=new Array(0),h=new Array(0),f=0,g=0,e=new _Ewa.w(!1),c="",nt=k.Items,et=nt.length,l=0;l<et;++l)i=nt[l],i.IsBoolean||i.IsNumber||i.IsString?(tt=i.IsBoolean?"rgba(0, 0, 255, 1)":i.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)",this.i(u,r,f,i.Span.Start,null),this.i(u,r,i.Span.Start,i.Span.End,tt),f=i.Span.End):_Ewa.a.a(819)?(i.Range||i.LetName&&i.LetNumber>=0)&&(s=null,i.Range?(a=_Ewa.h.b(i.Range),s=this.l(a,e,1),Array.add(o,new _Ewa.cK(a,b))):i.LetName&&i.LetNumber>=0&&(c=this.t(i.LetName,i.LetNumber,e,1,c),s=c,g!==e.a.length&&n.u().c(i.Span.Start+"-"+i.Span.End,this.g[(e.a.length-1)%this.g.length])),this.i(u,r,f,i.Span.Start,null),this.i(u,r,i.Span.Start,i.Span.End,s),f=i.Span.End,Array.add(d,i.Span),v=u.length-1,Array.add(h,new _Ewa.kr(v,u[v].text,i)),g=e.a.length):i.Range&&(y=_Ewa.h.b(i.Range),it=this.l(y,e,1),this.i(u,r,f,i.Span.Start,null),this.i(u,r,i.Span.Start,i.Span.End,it),Array.add(o,new _Ewa.cK(y,b)),f=i.Span.End,Array.add(d,i.Span),p=u.length-1,Array.add(h,new _Ewa.kr(p,u[p].text,i)));return(this.i(u,r,f,r.length,null),this.x(n,u,!!t),w=n.a().d(),!_Ewa.f.b(w,r,!1))?(Diag.a.b(38114182,0,!1,"ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [{0}], originalTextLength [{1}]",w.length,r.length),rt=n.a().e(),n.a().h(r),n.a().l(rt),!0):(this.n(o,e,h),_Ewa.a.a(819)&&o.length>0&&Diag.a.a(587559248,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored"),_Ewa.a.a(819)&&n.u().a.length>0&&Diag.a.a(587559247,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored"),this.j=!0,!0)}return(this.n(null,null,null),this.j&&(this.j=!1,n.a().E(r),t))?!0:!1},d:function(n){var t=n.b();_Ewa.bB.b(t)&&n.a().E(t)},a:function(n,t,i){var r,s,c,h,f,e;if(!n||!t||!i)return Diag.a.b(38926101,0,!!n,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),Diag.a.b(38926102,0,!!t,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),Diag.a.b(38926103,0,!!i,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;if(r=$$as(_Ewa.kr,t.h),!r)return Diag.a.b(38621456,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),!1;var l=r.g,o=r.c,u=this.f.e().n(i)?i.by(r.a,r.b):i.bb(r.a,r.b,r.d,r.e);if(!u)return Diag.a.b(38926104,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;if(s=o.indexOf("!"),s!==-1&&(u=o.substring(0,s+1)+u),c=n.a().bt(l,o,u),!c)return Diag.a.b(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;for(r.c=u,h=!0,f=1;f<=4;f++){if(e=_Ewa.c.a(this.h).l().e(3,f,t.f),!e){Diag.a.b(38926106,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null");h=!1;continue}e.b=i;e.h=r}return this.f.l().f(!1,!1),this.f.k().n()&&this.f.k().a().h(n.b()),this.f.k().w(new _Ewa.kF(!0)),h},c:function(n){if(n.c!==3)return Diag.a.b(38847496,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;var t=$$as(_Ewa.kr,n.h);return t?t.f:(Diag.a.b(38847497,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)},e:function(n,t){if(Diag.a.a(42767445,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(t?"suspending":"resuming")+" colored references"),t){this.n(null,null,null);var i=n.a().e(),r=n.a().j().length;n.a().h(n.a().d());n.a().o(i,i+r)}return this.q=t,!1},dispose:function(){this.f&&this.f.g()&&this.f.g().f(this.m)},l:function(n,t,i){var r=t.b[n.toString()]||null,u;return r||(u=t.a.length%this.g.length,r=this.g[u],t.c(n.toString(),r)),String.format(r,i)},t:function(n,t,i,r,u){var o="["+n+", "+t+"]",f=i.b[o]||null,e;return f||(e=i.a.length%this.g.length,f=this.g[e],u===String.format(f,r)&&(i.c("skip-"+o,f),e=i.a.length%this.g.length,f=this.g[e]),i.c(o,f)),String.format(f,r)},i:function(n,t,i,r,u){if(Diag.a.b(37859357,0,i<=r,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex"),i<r){var e=t.substring(i,r),f;Array.add(n,(f=new _Ewa.Cn,f.text=e,f.color=u,f))}},n:function(n,t,i){var u,r;if(!n||!n.length){u=this.h.o().a("UserAction","HideRangesHighlightsStopwatch");this.f.l().a([3]);this.f.l().l(new _Ewa.cK(null,this.s()),[3],!0);u.a();return}Diag.a.a(41492675,0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+n.length);n.reverse();i.reverse();r=this;this.f.l().d(n,[3],!0,function(n,u){if(!n||!n.b||!u){Diag.a.b(37859358,0,!!n,"ColoredReferencesManager.HighlightRanges: state is null");Diag.a.b(37859359,0,!!n.b,"ColoredReferencesManager.HighlightRanges: state.Range is null");Diag.a.b(37859360,0,!!u,"ColoredReferencesManager.HighlightRanges: div is null");return}Diag.a.b(37859361,0,t.d(n.b.toString()),"ColoredReferencesManager.HighlightRanges: The range '{0}' doesn't exist in the range to color dictionary",n.b.toString());var f=r.l(n.b,t,.1),e=r.l(n.b,t,1),o=!!r.h.s()&&!!r.h.s().Z()&&r.h.s().Z().a();o||(u.style.background=f);u.style.borderColor=e;i&&(u.setAttribute("IndexInMarqueeCollection",n.f),n.h=i[n.f])},!0)},x:function(n,t,i){n.a().k=!0;var r=n.a().e();n.a().bG(t);n.a().l(this.p?Math.min(r,n.a().d().length):r);i&&n.w(new _Ewa.kF(!1));n.a().k=!1},s:function(){return this.r().R},v:function(){return this.r().N},u:function(){return this.h.k().WorkbookFileName},r:function(){return this.f.I()&&this.f.I().b()?this.f.I().b():this.h.i()},w:function(){this.j=!1}};_Ewa.uF=function(n){_Ewa.uF.initializeBase(this);this.i=n;this.l()};_Ewa.uF.a=function(n){n.a().b(_Ewa.bjT.$$(_Ewa.gH),282,new _Ewa.uF(n))};_Ewa.uF.prototype={i:null,b:function(){var n=this;this.i.a().c(_Ewa.dQ,266,function(t){n.k(new _Ewa.ColoredReferencesManager(n.i,t))},null)}};_Ewa.kr=function(n,t,i){if(this.g=n,this.c=t,!i){Diag.a.b(39856346,0,!1,"MarqueeMetadata.Ctor: parseResultItem is null");return}this.f=i.IsRangeRef;this.b=i.IsAbsoluteFirstRow;this.a=i.IsAbsoluteFirstColumn;this.e=i.IsAbsoluteSecondRow;this.d=i.IsAbsoluteSecondColumn};_Ewa.kr.prototype={g:0,c:null,f:!1,b:!1,a:!1,e:!1,d:!1};_Ewa.RelativeAndAbsoluteReferencesManager=function(n){this.b=n};_Ewa.RelativeAndAbsoluteReferencesManager.d=function(n,t){return n.index<=t.index?n:t};_Ewa.RelativeAndAbsoluteReferencesManager.e=function(n,t){return t||n?t&&n?2:!t&&n?3:0:1};_Ewa.RelativeAndAbsoluteReferencesManager.prototype={b:null,a:function(n,t,i,r,u){var h;if(r.val=t,u.val=i,!n||!n.length||!_Ewa.bB.b(n))return n;if(h=this.b.j(n),!h)return Diag.a.a(39396451,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),null;for(var e=this.e(h,n,t,i),c=0,o=new Sys.StringBuilder,s=0,f=0;f<e.length;f++)if(this.c(e[f],t,i)){c=e[f].f();r.val=e[f].c;break}for(;f<e.length;f++){if(!this.c(e[f],t,i))break;o.append(n.substring(s,e[f].c));e[f].g(c,o);s=e[f].a}return s&&(u.val=o.toString().length),o.append(n.substring(s,n.length)),o.toString()},e:function(n,t,i,r){for(var ft,f,et,d,l,lt,u,e,y,at,g,a,vt,nt,v,yt,ot,tt,p,h,w,st,it,ht,rt,b,c,k,ct,ut,s=[],o=0;o<n.length;o++)if(ft=n[o],ft.kind==="range")if(f=ft.ref,f.type==="cell")et=f,lt=(l=new _Ewa.RelativeAndAbsoluteReferencesManager.b,l.c=f.span.start,l.a=f.span.end,l.b=[(d=new _Ewa.RelativeAndAbsoluteReferencesManager.a,d.a=et.col,d.b=et.row,d)],l.d=this.b.b(f.span.end,t),l),s.push(lt);else if(f.type==="range")u=f,this.d(u.topLeftSpan,i,r)&&this.d(u.bottomRightSpan,i,r)?(e=new _Ewa.RelativeAndAbsoluteReferencesManager.h,u.top.index<=u.bottom.index?(e.b=u.top,e.c=u.bottom):(e.c=u.top,e.b=u.bottom),u.left.index<=u.right.index?(e.a=u.left,e.d=u.right):(e.d=u.left,e.a=u.right),at=(y=new _Ewa.RelativeAndAbsoluteReferencesManager.i,y.c=u.topLeftSpan.start,y.a=u.bottomRightSpan.end,y.b=[e],y),s.push(at)):(vt=(a=new _Ewa.RelativeAndAbsoluteReferencesManager.b,a.c=u.topLeftSpan.start,a.a=u.topLeftSpan.end,a.b=[(g=new _Ewa.RelativeAndAbsoluteReferencesManager.a,g.a=u.left,g.b=u.top,g)],a.d=this.b.b(u.topLeftSpan.end,t),a),yt=(v=new _Ewa.RelativeAndAbsoluteReferencesManager.b,v.c=u.bottomRightSpan.start,v.a=u.bottomRightSpan.end,v.b=[(nt=new _Ewa.RelativeAndAbsoluteReferencesManager.a,nt.a=u.right,nt.b=u.bottom,nt)],v.d=this.b.b(u.topLeftSpan.end,t),v),s.push(vt),s.push(yt));else if(f.type==="col"){for(ot=f,h=(p=new _Ewa.RelativeAndAbsoluteReferencesManager.g,p.c=f.span.start,p.a=f.span.end,p.b=[(tt=new _Ewa.RelativeAndAbsoluteReferencesManager.c,tt.a=ot.startIndex,tt.b=ot.endIndex,tt)],p);h.a<t.length-1&&t.charAt(h.a)===":"&&o<n.length-1;)if(w=n[o+1].ref,w.type==="col"&&w.span.start===h.a+1)st=w,h.b.push((it=new _Ewa.RelativeAndAbsoluteReferencesManager.c,it.a=st.startIndex,it.b=st.endIndex,it)),h.a=w.span.end,o++;else break;s.push(h)}else if(f.type==="row"){for(ht=f,c=(b=new _Ewa.RelativeAndAbsoluteReferencesManager.j,b.c=f.span.start,b.a=f.span.end,b.b=[(rt=new _Ewa.RelativeAndAbsoluteReferencesManager.f,rt.a=ht.startIndex,rt.b=ht.endIndex,rt)],b);c.a<t.length-1&&t.charAt(c.a)===":"&&o<n.length-1;)if(k=n[o+1].ref,k.type==="row"&&k.span.start===c.a+1)ct=k,c.b.push((ut=new _Ewa.RelativeAndAbsoluteReferencesManager.f,ut.a=ct.startIndex,ut.b=ct.endIndex,ut)),c.a=k.span.end,o++;else break;s.push(c)}return s},c:function(n,t,i){return!(n.c>i||t>n.a)},d:function(n,t,i){return!(n.start>i||t>n.end)}};_Ewa.RelativeAndAbsoluteReferencesManager.k=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.k.prototype={c:0,a:0,b:null,g:function(n,t){for(var r,i=0;i<this.b.length;i++)r=this.e(n,this.b[i]),t.append(r),i<this.b.length-1&&t.append(":")}};_Ewa.RelativeAndAbsoluteReferencesManager.b=function(){_Ewa.RelativeAndAbsoluteReferencesManager.b.initializeBase(this)};_Ewa.RelativeAndAbsoluteReferencesManager.b.prototype={d:!1,f:function(){var n=this.b[0],t=n.b.kind==="Abs",i=n.a.kind==="Abs";return _Ewa.RelativeAndAbsoluteReferencesManager.e(t,i)},e:function(n,t){var i=t,u=i.b.index+1,f=i.a.index+1,r=_Ewa.q.a(u,f,!1);return this.d?r.by(n===1||n===3,n===1||n===2):r.bb(n===1||n===3,n===1||n===2,!0,!0)}};_Ewa.RelativeAndAbsoluteReferencesManager.i=function(){_Ewa.RelativeAndAbsoluteReferencesManager.i.initializeBase(this)};_Ewa.RelativeAndAbsoluteReferencesManager.i.prototype={f:function(){var n=this.b[0],t=n.b.kind==="Abs",i=n.a.kind==="Abs";return _Ewa.RelativeAndAbsoluteReferencesManager.e(t,i)},e:function(n,t){var i=t,f=i.b.index+1,e=i.c.index+1,o=i.a.index+1,s=i.d.index+1,h=new _Ewa.q(f,o,e,s,!1,!1),r=n===1||n===3,u=n===1||n===2;return h.bb(r,u,r,u)}};_Ewa.RelativeAndAbsoluteReferencesManager.g=function(){_Ewa.RelativeAndAbsoluteReferencesManager.g.initializeBase(this)};_Ewa.RelativeAndAbsoluteReferencesManager.g.prototype={f:function(){var n=this.b[0],t=_Ewa.RelativeAndAbsoluteReferencesManager.d(n.a,n.b),i=t.kind==="Abs";return i?2:3},e:function(n,t){var i=t,r=i.a.index+1,u=i.b.index+1,f=_Ewa.q.e(r,u,!1);return f.bb(n===1||n===3,!0,n===1||n===3,!0)}};_Ewa.RelativeAndAbsoluteReferencesManager.j=function(){_Ewa.RelativeAndAbsoluteReferencesManager.j.initializeBase(this)};_Ewa.RelativeAndAbsoluteReferencesManager.j.prototype={f:function(){var n=this.b[0],t=_Ewa.RelativeAndAbsoluteReferencesManager.d(n.a,n.b),i=t.kind==="Abs";return i?0:1},e:function(n,t){var i=t,r=i.a.index+1,u=i.b.index+1,f=_Ewa.q.f(r,u,!1);return f.bb(!0,n===1||n===2,!0,n===1||n===2)}};_Ewa.RelativeAndAbsoluteReferencesManager.a=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.a.prototype={b:null,a:null};_Ewa.RelativeAndAbsoluteReferencesManager.h=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.h.prototype={b:null,c:null,a:null,d:null};_Ewa.RelativeAndAbsoluteReferencesManager.c=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.c.prototype={a:null,b:null};_Ewa.RelativeAndAbsoluteReferencesManager.f=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.f.prototype={a:null,b:null};_Ewa.uG=function(n){_Ewa.uG.initializeBase(this);this.i=n;this.l()};_Ewa.uG.a=function(n){n.a().b(_Ewa.bjT.$$(_Ewa.lT),295,new _Ewa.uG(n))};_Ewa.uG.prototype={i:null,b:function(){var n=this;this.i.a().c(_Ewa.dQ,266,function(t){n.k(new _Ewa.RelativeAndAbsoluteReferencesManager(t))},null)}};_Ewa.dt.registerClass("_Ewa.dt",null,Sys.IDisposable);_Ewa.dt.d.registerClass("_Ewa.dt.d");_Ewa.dt.i.registerClass("_Ewa.dt.i");_Ewa.dt.g.registerClass("_Ewa.dt.g");_Ewa.dt.j.registerClass("_Ewa.dt.j");_Ewa.CalcManager.registerClass("_Ewa.CalcManager",null,_Ewa.dQ,Sys.IDisposable);_Ewa.uE.registerClass("_Ewa.uE",_Ewa.sr.$$(_Ewa.dQ));_Ewa.ColoredReferencesManager.registerClass("_Ewa.ColoredReferencesManager",null,_Ewa.gH,Sys.IDisposable);_Ewa.uF.registerClass("_Ewa.uF",_Ewa.sr.$$(_Ewa.gH));_Ewa.kr.registerClass("_Ewa.kr");_Ewa.RelativeAndAbsoluteReferencesManager.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager",null,_Ewa.lT);_Ewa.RelativeAndAbsoluteReferencesManager.k.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.k");_Ewa.RelativeAndAbsoluteReferencesManager.b.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.b",_Ewa.RelativeAndAbsoluteReferencesManager.k);_Ewa.RelativeAndAbsoluteReferencesManager.i.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.i",_Ewa.RelativeAndAbsoluteReferencesManager.k);_Ewa.RelativeAndAbsoluteReferencesManager.g.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.g",_Ewa.RelativeAndAbsoluteReferencesManager.k);_Ewa.RelativeAndAbsoluteReferencesManager.j.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.j",_Ewa.RelativeAndAbsoluteReferencesManager.k);_Ewa.RelativeAndAbsoluteReferencesManager.c.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.c");_Ewa.RelativeAndAbsoluteReferencesManager.f.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.f");_Ewa.uG.registerClass("_Ewa.uG",_Ewa.sr.$$(_Ewa.lT));_Ewa.gG.a="##ERR##";Type.registerNamespace("_Ewa");_Ewa.bdu=function(){};_Ewa.bdu.a=function(){_Ewa.l.a(_Ewa.uE.a);_Ewa.l.a(_Ewa.uF.a);_Ewa.l.a(_Ewa.uG.a)};_Ewa.bdu.a();